02b-flowmix on microbial community data
================
Compiled at 2023-08-08 21:41:34 UTC

``` r
here::i_am(paste0(params$name, ".Rmd"), uuid = "989c1b7b-94e7-44a3-ba84-4dfb55c493e8")
```

The purpose of this document is …

``` r
library("conflicted")
library(readxl)
library(purrr)
library(dplyr)
library(flowmix)
```

    ## Warning: replacing previous import 'RcppArmadillo::fastLmPure' by
    ## 'RcppEigen::fastLmPure' when loading 'flowmix'

    ## Warning: replacing previous import 'RcppArmadillo::fastLm' by
    ## 'RcppEigen::fastLm' when loading 'flowmix'

``` r
library(flowCore)
library(flowWorkspace)
library(ggcyto)
library(tidyverse)
library(RColorBrewer)
library(flowEMMi)
```

``` r
# create or *empty* the target directory, used to write this file's data: 
projthis::proj_create_dir_target(params$name, clean = TRUE)

# function to get path to target directory: path_target("sample.csv")
path_target <- projthis::proj_path_target(params$name)

# function to get path to previous data: path_source("00-import", "sample.csv")
path_source <- projthis::proj_path_source(params$name)
```

## Task1

In this part, we’re focusing on microbial communities from paper:
Neutral mechanisms and niche differentiation in steady-state insular
microbial communities reveald by single cell analysis by Liu et al.,
2019

This flow cytometry data consists of 5 reactors data.

C1 and C2 are two control reactors in order to test for neutral
behaviour under undisturbed communities.

D1, D2 and D3 were disturbed by a repeated and soft temperature stressor
from 30 to 40 degrees.

Liu et. al sampled from all five reactors and analyzed them by flow
cytometry. All raw data can be accessed by flowRepository
(<https://flowrepository.org/>) under accession number: FR-FCM-ZYWX.

### Import data

``` r
path_Liu <- "~/Desktop/FlowRepository_Liu/"
file_name_Liu <- list.files(path_Liu,pattern = "\\.fcs$",full.names = T)
C1_data <- list()

for (i in file_name_Liu){
  data <- read.FCS(i,alter.names = T,transformation = F)
  new_name <- substr(i,start = 43,stop=57)
  C1_data[[new_name]] <- data
}
```

    ## [1] "The whole experiment has 65 time points"

``` r
test1 <-C1_data[[1]]
ggcyto(test1, aes(x = "PMT.1", y = "PMT.9")) + geom_hex(bins = 128)
```

![](02b-flowmix-on-microbial-community-data_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

Below is another visulization method supported by flowEMMI v2 package

``` r
plotDensityAndEllipses(fcsData = test1, ch1="PMT.1", ch2="PMT.9",logScale = F,
                       axis_size=10, axisLabeling_size=10,
                       xlab = "Forward Scatter", ylab = "DAPI", font = "Arial")
```

### flowEMMI v2

Since each time point contains around 200k cells, every run takes about
30mins, here is an example of one time point.

``` r
fdo_test1 <- mkFlowDataObject(test1, xChannel="PMT.1", yChannel="PMT.9")

set.seed(1)
gating_test1 <- flowEMMi( fdo=fdo_test1
                       , xMin=1, xMax=60000, yMin=1, yMax=60000
                       , initFraction=0.01
                       , finalFraction=1.0
                       , minClusters=5, maxClusters=15, clusterbracket=2
                       , numberOfInits=5
                       , verbose=TRUE
                       , parallel=FALSE
                       , convergenceEpsilon=0.01
                       , whenToRemoveOverlaps = 20
                       , mergeWhenCenter = FALSE
                       , mergeWhenTwoCenters = FALSE
                       , thresholdForDeletion = 0.2
                       , threshold = 0.9
                       , considerWeights=TRUE
                       , plot = FALSE
                       , alpha=0.9
                       , minMinor=500
)
```

    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10       475.9573    0.033 0.163 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.0755    0.012 0.155 0.833 ... 
    ##    30         0.0339    0.010 0.169 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0335    0.012 0.155 0.833 ... 
    ##    50         0.0351    0.010 0.170 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0379    0.012 0.156 0.833 ... 
    ##    70         0.0418    0.010 0.171 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0472    0.012 0.156 0.832 ... 
    ##    90         0.0547    0.010 0.172 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0653    0.012 0.156 0.832 ... 
    ##   110         0.0807    0.010 0.173 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1047    0.012 0.156 0.832 ... 
    ##   130         0.1452    0.010 0.174 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2219    0.012 0.156 0.832 ... 
    ##   150         0.3727    0.010 0.175 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.5550    0.012 0.157 0.831 ... 
    ##   170         0.4330    0.010 0.178 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1645    0.012 0.157 0.831 ... 
    ##   190         0.0425    0.010 0.179 0.130 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0090    0.012 0.157 0.831 ... 
    ##   201         0.0090
    ## timing iterateEM: 2.226 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10         1.6219    0.072 0.146 0.318 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.4459    0.080 0.165 0.755 ... 
    ##    30         0.0164    0.072 0.097 0.315 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0263    0.079 0.163 0.758 ... 
    ##    50         0.0504    0.072 0.097 0.333 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0958    0.080 0.163 0.757 ... 
    ##    70         0.1750    0.072 0.096 0.367 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2996    0.080 0.163 0.757 ... 
    ##    90         0.4983    0.073 0.094 0.421 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.8003    0.082 0.162 0.756 ... 
    ##   110         0.7804    0.075 0.092 0.487 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2585    0.076 0.092 0.147 ... 
    ##   130         0.0446    0.076 0.092 0.523 ... 
    ##   140         0.0084
    ## timing iterateEM: 1.189 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10         5.7301    0.086 0.350 0.227 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.1921    0.139 0.609 0.252 ... 
    ##    30         0.0766    0.084 0.376 0.283 ... 
    ##    40         0.0099
    ## timing iterateEM: 0.176 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10        18.6428    0.075 0.395 0.253 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.0704    0.084 0.164 0.752 ... 
    ##    30         0.0936    0.074 0.439 0.227 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1311    0.083 0.164 0.753 ... 
    ##    50         0.1606    0.074 0.481 0.184 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1672    0.083 0.164 0.753 ... 
    ##    70         0.1460    0.073 0.526 0.139 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1084    0.083 0.164 0.753 ... 
    ##    90         0.0724    0.073 0.558 0.105 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0481    0.083 0.164 0.753 ... 
    ##   110         0.0358    0.073 0.576 0.086 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0337    0.083 0.165 0.752 ... 
    ##   130         0.0433    0.073 0.587 0.074 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0790    0.083 0.675 0.077 ... 
    ##   150         0.1744    0.073 0.599 0.061 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2194    0.083 0.691 0.061 ... 
    ##   170         0.1484    0.073 0.613 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1544    0.073 0.619 0.039 ... 
    ##   190         0.1357    0.073 0.626 0.032 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0650    0.073 0.631 0.027 ... 
    ##   210         0.0128    0.073 0.634 0.025 ... 
    ##   213         0.0085
    ## timing iterateEM: 1.73 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10        31.1584    0.093 0.115 0.338 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.6193    0.102 0.667 0.231 ... 
    ##    30         0.8357    0.067 0.070 0.520 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1854    0.079 0.080 0.656 ... 
    ##    50         0.0328    0.067 0.067 0.567 ... 
    ##    58         0.0092
    ## timing iterateEM: 0.336 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10         6.7442    0.049 0.145 0.460 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.4608    0.057 0.182 0.760 ... 
    ##    30        29.3621    0.010 0.180 0.471 ... 
    ## [1] "Removing overlaps!"
    ##    40        14.2569    0.020 0.753 0.228 ... 
    ##    50         0.0046
    ## timing iterateEM: 0.56 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10      1068.1421    0.010 0.132 0.615 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.1747    0.011 0.739 0.016 ... 
    ##    30        33.7308    0.019 0.143 0.680 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2854    0.032 0.733 0.031 ... 
    ##    50         0.0095    0.030 0.143 0.672 ... 
    ##    51         0.0095
    ## timing iterateEM: 0.465 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10       479.2145    0.014 0.163 0.089 ... 
    ## [1] "Removing overlaps!"
    ##    20        24.8761    0.016 0.222 0.762 ... 
    ##    30         1.1694    0.013 0.194 0.074 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5403    0.028 0.725 0.246 ... 
    ##    50         0.0531    0.023 0.164 0.076 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0378    0.031 0.729 0.241 ... 
    ##    70         0.1475    0.024 0.154 0.081 ... 
    ##    80         0.0090
    ## timing iterateEM: 0.522 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10        13.4738    0.010 0.590 0.080 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.8659    0.015 0.679 0.047 ... 
    ##    30         0.1191    0.017 0.622 0.094 ... 
    ##    37         0.0077
    ## timing iterateEM: 0.258 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10        17.7013    0.072 0.151 0.114 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.6895    0.099 0.213 0.688 ... 
    ##    30         0.3556    0.070 0.151 0.065 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.8314    0.075 0.162 0.054 ... 
    ##    50         1.4845    0.071 0.151 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.5195    0.097 0.206 0.037 ... 
    ##    70         4.6961    0.074 0.151 0.023 ... 
    ##    77         0.0076
    ## timing iterateEM: 0.572 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10        15.0032    0.046 0.212 0.151 ... 
    ## [1] "Removing overlaps!"
    ##    20        18.3788    0.059 0.655 0.286 ... 
    ##    30        31.5530    0.010 0.249 0.150 ... 
    ## [1] "Removing overlaps!"
    ##    40        42.2436    0.011 0.769 0.220 ... 
    ##    50         0.4013    0.010 0.228 0.150 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1699    0.011 0.771 0.218 ... 
    ##    70         0.1120    0.010 0.180 0.150 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0734    0.011 0.770 0.218 ... 
    ##    90         0.0469    0.010 0.148 0.150 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0298    0.011 0.770 0.219 ... 
    ##   110         0.0193    0.010 0.129 0.150 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0129    0.011 0.770 0.219 ... 
    ##   128         0.0099
    ## timing iterateEM: 1.575 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10        59.8240    0.034 0.076 0.114 ... 
    ## [1] "Removing overlaps!"
    ##    20         9.3097    0.021 0.644 0.335 ... 
    ##    30         0.4886    0.028 0.066 0.089 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2699    0.048 0.619 0.334 ... 
    ##    50         0.2885    0.029 0.066 0.093 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2697    0.052 0.592 0.356 ... 
    ##    70         0.1728    0.029 0.073 0.099 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0733    0.054 0.573 0.372 ... 
    ##    90         0.0295    0.029 0.078 0.102 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0188    0.036 0.371 0.346 ... 
    ##   110         0.0258    0.030 0.080 0.105 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0507    0.036 0.381 0.335 ... 
    ##   130         0.1055    0.030 0.082 0.107 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2014    0.037 0.406 0.308 ... 
    ##   150         0.2806    0.030 0.086 0.111 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2052    0.037 0.444 0.268 ... 
    ##   170         0.0822    0.029 0.091 0.112 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0304    0.037 0.470 0.241 ... 
    ##   190         0.0129    0.029 0.092 0.111 ... 
    ##   195         0.0094
    ## timing iterateEM: 2.274 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10       483.9812    0.010 0.079 0.035 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.6148    0.014 0.709 0.277 ... 
    ##    30        74.0360    0.010 0.043 0.073 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.8666    0.013 0.728 0.260 ... 
    ##    50         0.4982    0.010 0.042 0.098 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0942    0.012 0.734 0.254 ... 
    ##    70         0.0194    0.010 0.042 0.103 ... 
    ##    76         0.0092
    ## timing iterateEM: 0.654 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10        23.3470    0.010 0.197 0.283 ... 
    ## [1] "Removing overlaps!"
    ##    20        27.0042    0.022 0.684 0.294 ... 
    ##    30         4.5397    0.010 0.269 0.318 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.2766    0.023 0.369 0.382 ... 
    ##    50         6.1784    0.023 0.306 0.289 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1474    0.034 0.395 0.353 ... 
    ##    70         0.0267    0.027 0.320 0.273 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0219    0.035 0.413 0.335 ... 
    ##    90         0.0272    0.027 0.335 0.258 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0349    0.034 0.434 0.315 ... 
    ##   110         0.0443    0.027 0.355 0.241 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0548    0.034 0.461 0.289 ... 
    ##   130         0.0646    0.027 0.381 0.220 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0711    0.034 0.752 0.215 ... 
    ##   150         0.0719    0.027 0.409 0.197 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0660    0.033 0.753 0.213 ... 
    ##   170         0.0548    0.027 0.434 0.176 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0411    0.033 0.755 0.212 ... 
    ##   190         0.0277    0.027 0.453 0.160 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0169    0.033 0.755 0.212 ... 
    ##   210         0.0094    0.027 0.465 0.150 ... 
    ##   211         0.0094
    ## timing iterateEM: 2.604 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10         2.6311    0.079 0.115 0.107 ... 
    ## [1] "Removing overlaps!"
    ##    20         6.7225    0.348 0.652 0.000 ... 
    ##    30         1.6845    0.079 0.107 0.084 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.7754    0.347 0.653 0.000 ... 
    ##    50         1.0437    0.079 0.112 0.079 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4427    0.186 0.349 0.464 ... 
    ##    70         0.2244    0.080 0.133 0.076 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1319    0.183 0.343 0.474 ... 
    ##    90         0.0768    0.080 0.154 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0458    0.183 0.341 0.476 ... 
    ##   110         0.0284    0.080 0.166 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0185    0.183 0.342 0.475 ... 
    ##   130         0.0127    0.080 0.170 0.075 ... 
    ##   139         0.0099
    ## timing iterateEM: 1.286 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10       941.4248    0.010 0.354 0.316 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.4783    0.070 0.930 0.000 ... 
    ##    30         0.7935    0.010 0.337 0.339 ... 
    ## [1] "Removing overlaps!"
    ##    40         5.4140    0.070 0.930 0.000 ... 
    ##    50        21.3752    0.015 0.285 0.346 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4973    0.110 0.890 0.000 ... 
    ##    70         0.5987    0.022 0.240 0.346 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.8111    0.103 0.897 0.000 ... 
    ##    90         0.2270    0.020 0.194 0.378 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0970    0.102 0.898 0.000 ... 
    ##   110         0.0438    0.020 0.168 0.405 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0193    0.101 0.899 0.000 ... 
    ##   130         0.0092
    ## timing iterateEM: 1.397 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10        43.0406    0.038 0.068 0.308 ... 
    ## [1] "Removing overlaps!"
    ##    20        30.5264    0.047 0.953 0.000 ... 
    ##    30        16.1164    0.021 0.054 0.303 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.0738    0.094 0.123 0.783 ... 
    ##    50         3.0986    0.023 0.066 0.271 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.8287    0.096 0.085 0.819 ... 
    ##    70         0.2498    0.022 0.090 0.258 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0825    0.096 0.083 0.822 ... 
    ##    90         0.0214    0.022 0.093 0.263 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0105    0.096 0.083 0.821 ... 
    ##   103         0.0098
    ## timing iterateEM: 1.422 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10       248.0874    0.049 0.011 0.107 ... 
    ## [1] "Removing overlaps!"
    ##    20         7.3166    0.019 0.616 0.365 ... 
    ##    30         1.9475    0.012 0.017 0.119 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.0281    0.012 0.056 0.718 ... 
    ##    50         0.2954    0.010 0.024 0.118 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1317    0.012 0.760 0.228 ... 
    ##    70         0.0832    0.010 0.022 0.116 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0543    0.012 0.760 0.227 ... 
    ##    90         0.0495    0.010 0.020 0.113 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1293    0.026 0.497 0.477 ... 
    ##   110         1.0743    0.010 0.018 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0498    0.026 0.489 0.485 ... 
    ##   130         0.0086    0.010 0.016 0.116 ... 
    ##   131         0.0086
    ## timing iterateEM: 1.713 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10         5.4039    0.069 0.215 0.054 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.7940    0.332 0.668 0.000 ... 
    ##    30         1.1969    0.071 0.237 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6749    0.336 0.664 0.000 ... 
    ##    50         0.3272    0.072 0.247 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3787    0.337 0.663 0.000 ... 
    ##    70         0.5572    0.072 0.227 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5749    0.315 0.617 0.068 ... 
    ##    90         0.6000    0.072 0.188 0.060 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2391    0.321 0.628 0.051 ... 
    ##   110         0.3612    0.072 0.160 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   120         2.7705    0.177 0.347 0.073 ... 
    ##   130         8.3505    0.073 0.147 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0541    0.117 0.224 0.029 ... 
    ##   150         0.0305    0.073 0.138 0.070 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0688    0.117 0.216 0.226 ... 
    ##   170         0.4684    0.073 0.132 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0484    0.118 0.209 0.229 ... 
    ##   182         0.0082
    ## timing iterateEM: 2.234 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10        43.7665    0.010 0.084 0.156 ... 
    ## [1] "Removing overlaps!"
    ##    20         6.5862    0.061 0.939 0.000 ... 
    ##    30         4.1666    0.023 0.043 0.173 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.4657    0.133 0.867 0.000 ... 
    ##    50         0.1357    0.028 0.038 0.174 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0799    0.075 0.440 0.485 ... 
    ##    70         0.0812    0.028 0.038 0.156 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0950    0.079 0.409 0.512 ... 
    ##    90         0.1096    0.028 0.038 0.135 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1162    0.084 0.369 0.547 ... 
    ##   110         0.1205    0.028 0.038 0.113 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1317    0.090 0.328 0.582 ... 
    ##   130         0.1426    0.028 0.038 0.094 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1321    0.095 0.289 0.616 ... 
    ##   150         0.0945    0.028 0.038 0.079 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0527    0.099 0.257 0.644 ... 
    ##   170         0.0252    0.028 0.038 0.069 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0115    0.102 0.239 0.660 ... 
    ##   183         0.0099
    ## timing iterateEM: 2.194 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        36.1421    0.013 0.087 0.087 ... 
    ## [1] "Removing overlaps!"
    ##    20         6.8149    0.048 0.952 0.000 ... 
    ##    30        23.8397    0.022 0.102 0.120 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1482    0.127 0.873 0.000 ... 
    ##    50         0.1273    0.027 0.107 0.120 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1306    0.127 0.873 0.000 ... 
    ##    70         0.1071    0.027 0.113 0.120 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0808    0.127 0.873 0.000 ... 
    ##    90         0.0720    0.027 0.119 0.120 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1368    0.128 0.872 0.000 ... 
    ##   110         0.4760    0.027 0.124 0.121 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.8554    0.128 0.872 0.000 ... 
    ##   130         0.4714    0.027 0.115 0.123 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1612    0.128 0.872 0.000 ... 
    ##   150         0.0804    0.027 0.094 0.121 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0605    0.128 0.872 0.000 ... 
    ##   170         0.0578    0.027 0.088 0.120 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0574    0.127 0.873 0.000 ... 
    ##   190         0.0513    0.027 0.088 0.121 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0390    0.127 0.873 0.000 ... 
    ##   210         0.0262    0.027 0.090 0.121 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0167    0.127 0.873 0.000 ... 
    ##   230         0.0108    0.027 0.091 0.121 ... 
    ##   233         0.0099
    ## timing iterateEM: 5.102 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10       378.8237    0.025 0.067 0.039 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.4509    0.106 0.894 0.000 ... 
    ##    30         1.7320    0.027 0.087 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.2236    0.133 0.867 0.000 ... 
    ##    50         1.3071    0.026 0.124 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4506    0.127 0.873 0.000 ... 
    ##    70         0.5681    0.025 0.135 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5022    0.126 0.874 0.000 ... 
    ##    90         0.2922    0.025 0.137 0.036 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2099    0.126 0.874 0.000 ... 
    ##   110         0.2119    0.025 0.152 0.036 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1914    0.070 0.446 0.484 ... 
    ##   130         0.1412    0.025 0.172 0.036 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0895    0.067 0.472 0.462 ... 
    ##   150         0.0531    0.025 0.187 0.036 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0318    0.065 0.489 0.446 ... 
    ##   170         0.0200    0.025 0.198 0.036 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0131    0.063 0.500 0.437 ... 
    ##   188         0.0099
    ## timing iterateEM: 4.092 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        27.8667    0.013 0.129 0.054 ... 
    ## [1] "Removing overlaps!"
    ##    20        69.9478    0.051 0.222 0.727 ... 
    ##    30         2.6491    0.010 0.160 0.032 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.3783    0.045 0.100 0.855 ... 
    ##    50         0.5343    0.010 0.172 0.017 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1340    0.047 0.077 0.876 ... 
    ##    70         0.1061    0.010 0.181 0.017 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0825    0.028 0.046 0.403 ... 
    ##    90         0.0623    0.010 0.186 0.017 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0465    0.029 0.049 0.368 ... 
    ##   110         0.0347    0.010 0.189 0.017 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0254    0.031 0.051 0.341 ... 
    ##   130         0.0175    0.010 0.191 0.017 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0111    0.032 0.052 0.322 ... 
    ##   144         0.0095
    ## timing iterateEM: 2.565 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        88.9660    0.010 0.066 0.117 ... 
    ## [1] "Removing overlaps!"
    ##    20        20.4628    0.088 0.912 0.000 ... 
    ##    30         2.1417    0.022 0.045 0.149 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.3657    0.094 0.119 0.787 ... 
    ##    50         0.6185    0.022 0.025 0.173 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2091    0.097 0.107 0.796 ... 
    ##    70         0.0970    0.023 0.025 0.169 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0520    0.097 0.107 0.796 ... 
    ##    90         0.0302    0.023 0.025 0.164 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0188    0.061 0.068 0.368 ... 
    ##   110         0.0127    0.023 0.025 0.158 ... 
    ##   119         0.0098
    ## timing iterateEM: 1.738 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        54.9956    0.052 0.017 0.190 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.4303    0.086 0.224 0.690 ... 
    ##    30         2.2864    0.018 0.046 0.194 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.1087    0.075 0.183 0.177 ... 
    ##    50         0.7921    0.019 0.046 0.210 ... 
    ## [1] "Removing overlaps!"
    ##    60         6.2262    0.081 0.197 0.114 ... 
    ##    70         2.8499    0.019 0.046 0.227 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.3235    0.052 0.124 0.052 ... 
    ##    90         0.1483    0.019 0.046 0.272 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0886    0.053 0.128 0.053 ... 
    ##   110         0.0540    0.019 0.046 0.305 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0329    0.054 0.130 0.054 ... 
    ##   130         0.0203    0.019 0.046 0.326 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0129    0.054 0.131 0.054 ... 
    ##   148         0.0096
    ## timing iterateEM: 1.86 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        21.8127    0.010 0.060 0.186 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.9845    0.047 0.953 0.000 ... 
    ##    30         2.5516    0.010 0.050 0.167 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.0988    0.047 0.953 0.000 ... 
    ##    50         0.5383    0.010 0.053 0.176 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2479    0.047 0.953 0.000 ... 
    ##    70         0.1014    0.010 0.055 0.191 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0435    0.047 0.953 0.000 ... 
    ##    90         0.0223    0.010 0.056 0.199 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0132    0.033 0.290 0.676 ... 
    ##   108         0.0096
    ## timing iterateEM: 2.002 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        14.9787    0.010 0.003 0.078 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.4357    0.046 0.954 0.000 ... 
    ##    30        37.4442    0.022 0.005 0.095 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.2748    0.096 0.904 0.000 ... 
    ##    50         4.0188    0.010 0.016 0.083 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.9687    0.049 0.951 0.000 ... 
    ##    70         0.1947    0.010 0.016 0.078 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0567    0.049 0.951 0.000 ... 
    ##    90         0.0225    0.010 0.016 0.077 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0104    0.049 0.951 0.000 ... 
    ##   102         0.0096
    ## timing iterateEM: 1.807 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        33.7082    0.010 0.058 0.149 ... 
    ## [1] "Removing overlaps!"
    ##    20         9.9686    0.048 0.952 0.000 ... 
    ##    30         6.1697    0.010 0.040 0.149 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.9912    0.040 0.148 0.813 ... 
    ##    50         0.0954    0.010 0.039 0.149 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1443    0.042 0.114 0.844 ... 
    ##    70         0.1384    0.010 0.039 0.149 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1074    0.042 0.114 0.844 ... 
    ##    90         0.0715    0.010 0.039 0.149 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0409    0.042 0.114 0.845 ... 
    ##   110         0.0207    0.010 0.039 0.149 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0097    0.042 0.114 0.845 ... 
    ##   121         0.0097
    ## timing iterateEM: 1.86 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10       897.2604    0.010 0.195 0.051 ... 
    ## [1] "Removing overlaps!"
    ##    20       122.3538    0.017 0.657 0.081 ... 
    ##    30         1.2357    0.010 0.258 0.065 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5107    0.018 0.009 0.624 ... 
    ##    50         0.4649    0.010 0.296 0.069 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.4106    0.012 0.006 0.745 ... 
    ##    70         0.5497    0.010 0.334 0.090 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.6003    0.013 0.007 0.741 ... 
    ##    90         0.5841    0.010 0.402 0.092 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2951    0.012 0.007 0.745 ... 
    ##   110         0.0901    0.010 0.455 0.092 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0223    0.012 0.007 0.748 ... 
    ##   127         0.0093
    ## timing iterateEM: 2.784 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        12.0557    0.010 0.132 0.057 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.6570    0.067 0.933 0.000 ... 
    ##    30        41.0251    0.010 0.146 0.027 ... 
    ## [1] "Removing overlaps!"
    ##    40        20.8222    0.091 0.909 0.000 ... 
    ##    50         0.0892    0.023 0.144 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0500    0.111 0.889 0.000 ... 
    ##    70         0.0553    0.023 0.145 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0757    0.111 0.889 0.000 ... 
    ##    90         0.1199    0.023 0.147 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2235    0.111 0.889 0.000 ... 
    ##   110         0.5270    0.023 0.150 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.2152    0.110 0.890 0.000 ... 
    ##   130         0.3940    0.023 0.152 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0742    0.109 0.891 0.000 ... 
    ##   150         0.0276    0.022 0.158 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0177    0.108 0.892 0.000 ... 
    ##   170         0.0140    0.022 0.162 0.046 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0119    0.071 0.349 0.581 ... 
    ##   190         0.0105    0.022 0.164 0.046 ... 
    ##   195         0.0099
    ## timing iterateEM: 3.21 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        27.0303    0.054 0.004 0.105 ... 
    ## [1] "Removing overlaps!"
    ##    20        65.5714    0.047 0.031 0.922 ... 
    ##    30         4.8595    0.011 0.006 0.122 ... 
    ## [1] "Removing overlaps!"
    ##    40         5.2160    0.080 0.022 0.898 ... 
    ##    50         0.7090    0.026 0.004 0.140 ... 
    ## [1] "Removing overlaps!"
    ##    60         2.4568    0.133 0.013 0.854 ... 
    ##    70         0.1528    0.032 0.002 0.148 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2166    0.148 0.016 0.835 ... 
    ##    90         0.2382    0.032 0.004 0.155 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3138    0.119 0.013 0.194 ... 
    ##   110         1.1632    0.032 0.004 0.160 ... 
    ## [1] "Removing overlaps!"
    ##   120         2.4655    0.130 0.016 0.131 ... 
    ##   130         0.1903    0.034 0.004 0.168 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1356    0.138 0.020 0.116 ... 
    ##   150         0.0714    0.034 0.005 0.179 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0520    0.138 0.022 0.115 ... 
    ##   170         0.0451    0.034 0.006 0.189 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0429    0.138 0.023 0.115 ... 
    ##   190         0.0415    0.034 0.006 0.196 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0394    0.138 0.023 0.114 ... 
    ##   210         0.0361    0.034 0.006 0.201 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0317    0.138 0.023 0.114 ... 
    ##   230         0.0262    0.034 0.006 0.204 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0199    0.138 0.023 0.114 ... 
    ##   250         0.0138    0.034 0.006 0.206 ... 
    ##   259         0.0098
    ## timing iterateEM: 4.498 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        57.3074    0.010 0.042 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    20        66.4945    0.065 0.935 0.000 ... 
    ##    30         0.7833    0.010 0.036 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1647    0.024 0.630 0.346 ... 
    ##    50         0.2430    0.010 0.028 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4247    0.024 0.056 0.576 ... 
    ##    70         0.2578    0.010 0.019 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2641    0.026 0.043 0.557 ... 
    ##    90         0.5295    0.010 0.014 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1795    0.029 0.029 0.532 ... 
    ##   110         0.6086    0.010 0.010 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.3044    0.028 0.026 0.479 ... 
    ##   130         0.0219    0.010 0.009 0.133 ... 
    ##   139         0.0098
    ## timing iterateEM: 1.968 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        47.9085    0.010 0.147 0.081 ... 
    ## [1] "Removing overlaps!"
    ##    20        38.7796    0.047 0.953 0.000 ... 
    ##    30         2.2978    0.010 0.146 0.140 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.3876    0.047 0.953 0.000 ... 
    ##    50         0.6783    0.010 0.146 0.168 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.6708    0.047 0.953 0.000 ... 
    ##    70         0.4657    0.010 0.146 0.176 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.3447    0.047 0.953 0.000 ... 
    ##    90         0.2884    0.010 0.146 0.168 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1867    0.047 0.953 0.000 ... 
    ##   110         0.1226    0.010 0.146 0.161 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0933    0.047 0.953 0.000 ... 
    ##   130         0.0752    0.010 0.146 0.156 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0603    0.047 0.953 0.000 ... 
    ##   150         0.0472    0.010 0.146 0.152 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0365    0.047 0.953 0.000 ... 
    ##   170         0.0283    0.010 0.146 0.149 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0222    0.047 0.953 0.000 ... 
    ##   190         0.0177    0.010 0.146 0.147 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0141    0.047 0.953 0.000 ... 
    ##   210         0.0113    0.010 0.146 0.145 ... 
    ##   217         0.0099
    ## timing iterateEM: 3.865 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        27.5980    0.016 0.081 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.4174    0.144 0.856 0.000 ... 
    ##    30         0.5644    0.026 0.102 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5751    0.147 0.853 0.000 ... 
    ##    50         0.7797    0.026 0.117 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.4829    0.121 0.171 0.707 ... 
    ##    70         1.7385    0.026 0.131 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.7691    0.086 0.063 0.375 ... 
    ##    90         0.6392    0.027 0.133 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   100         1.0170    0.087 0.061 0.338 ... 
    ##   110         5.6343    0.025 0.123 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.8940    0.086 0.046 0.343 ... 
    ##   130         0.3651    0.024 0.113 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.3989    0.083 0.046 0.350 ... 
    ##   150         0.8991    0.024 0.111 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2000    0.083 0.045 0.353 ... 
    ##   170         0.1101    0.024 0.113 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0756    0.084 0.046 0.348 ... 
    ##   190         0.0542    0.024 0.112 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0427    0.085 0.046 0.338 ... 
    ##   210         0.0356    0.024 0.112 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0302    0.087 0.047 0.328 ... 
    ##   230         0.0259    0.024 0.114 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0231    0.088 0.047 0.321 ... 
    ##   250         0.0223    0.024 0.117 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0237    0.130 0.070 0.800 ... 
    ##   270         0.0279    0.024 0.121 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0362    0.130 0.070 0.800 ... 
    ##   290         0.0505    0.024 0.125 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.0704    0.131 0.070 0.799 ... 
    ##   310         0.0858    0.025 0.128 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   320         0.0830    0.131 0.070 0.799 ... 
    ##   330         0.0682    0.025 0.130 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   340         0.0548    0.093 0.290 0.049 ... 
    ##   350         0.0471    0.025 0.132 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   360         0.0437    0.072 0.192 0.038 ... 
    ##   370         0.0429    0.025 0.133 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   380         0.0427    0.073 0.170 0.039 ... 
    ##   390         0.0407    0.025 0.134 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   400         0.0353    0.075 0.151 0.039 ... 
    ##   410         0.0267    0.025 0.135 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   420         0.0175    0.076 0.137 0.040 ... 
    ##   430         0.0102    0.025 0.136 0.137 ... 
    ##   432         0.0097
    ## timing iterateEM: 7.358 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        53.8728    0.010 0.006 0.138 ... 
    ## [1] "Removing overlaps!"
    ##    20        17.5993    0.068 0.932 0.000 ... 
    ##    30         5.6862    0.010 0.016 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.1579    0.022 0.031 0.492 ... 
    ##    50         1.7982    0.011 0.015 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    60         2.2864    0.024 0.032 0.384 ... 
    ##    70         1.5667    0.011 0.014 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.4020    0.030 0.034 0.327 ... 
    ##    90         0.2955    0.012 0.015 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2083    0.028 0.039 0.317 ... 
    ##   110         0.0784    0.011 0.017 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1174    0.028 0.044 0.318 ... 
    ##   130         0.0768    0.011 0.018 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0368    0.027 0.046 0.321 ... 
    ##   150         0.0213    0.011 0.019 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0215    0.027 0.046 0.321 ... 
    ##   170         0.0377    0.011 0.019 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0808    0.027 0.046 0.322 ... 
    ##   190         0.2275    0.011 0.018 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.4236    0.027 0.040 0.322 ... 
    ##   210         0.1264    0.011 0.014 0.137 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0110    0.027 0.031 0.321 ... 
    ##   222         0.0089
    ## timing iterateEM: 4.619 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10       123.6022    0.010 0.070 0.128 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.8376    0.052 0.948 0.000 ... 
    ##    30         3.2287    0.010 0.051 0.148 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.0318    0.045 0.202 0.133 ... 
    ##    50         0.5329    0.010 0.048 0.156 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1895    0.028 0.388 0.123 ... 
    ##    70         0.0652    0.010 0.048 0.166 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0301    0.029 0.359 0.129 ... 
    ##    90         0.0171    0.010 0.048 0.174 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0101    0.030 0.349 0.131 ... 
    ##   102         0.0096
    ## timing iterateEM: 2.09 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        27.6544    0.010 0.085 0.116 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.8938    0.107 0.893 0.000 ... 
    ##    30         0.6480    0.018 0.064 0.115 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.0408    0.111 0.889 0.000 ... 
    ##    50         0.7992    0.018 0.050 0.115 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2348    0.110 0.890 0.000 ... 
    ##    70         0.1672    0.019 0.044 0.115 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1352    0.112 0.888 0.000 ... 
    ##    90         0.1195    0.019 0.041 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1250    0.112 0.888 0.000 ... 
    ##   110         0.1497    0.019 0.039 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1934    0.113 0.887 0.000 ... 
    ##   130         0.2431    0.019 0.037 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2634    0.113 0.887 0.000 ... 
    ##   150         0.2648    0.019 0.036 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2483    0.114 0.886 0.000 ... 
    ##   170         0.1622    0.019 0.036 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0887    0.057 0.502 0.441 ... 
    ##   190         0.0482    0.019 0.037 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0301    0.057 0.499 0.443 ... 
    ##   210         0.0244    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0242    0.058 0.498 0.445 ... 
    ##   230         0.0239    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0207    0.052 0.102 0.447 ... 
    ##   250         0.0173    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0167    0.052 0.102 0.448 ... 
    ##   270         0.0216    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0370    0.051 0.102 0.449 ... 
    ##   290         0.0540    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.0422    0.051 0.102 0.450 ... 
    ##   310         0.0225    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   320         0.0138    0.051 0.103 0.451 ... 
    ##   330         0.0117    0.019 0.039 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   340         0.0161    0.057 0.503 0.440 ... 
    ##   350         0.0681    0.019 0.038 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   360         0.8529    0.048 0.091 0.051 ... 
    ##   370         1.1475    0.019 0.027 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   380         0.1016    0.055 0.061 0.470 ... 
    ##   390         0.1567    0.019 0.021 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   400         0.4607    0.048 0.058 0.473 ... 
    ##   410         0.0723    0.016 0.017 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   420         0.0499    0.046 0.057 0.475 ... 
    ##   430         4.9339    0.016 0.019 0.115 ... 
    ## [1] "Removing overlaps!"
    ##   440         0.0165    0.045 0.048 0.481 ... 
    ##   450         0.0116    0.016 0.019 0.115 ... 
    ##   457         0.0099
    ## timing iterateEM: 8.836 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10         7.1261    0.010 0.132 0.050 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.7200    0.087 0.913 0.000 ... 
    ##    30         3.9297    0.024 0.135 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    40        12.8114    0.100 0.089 0.811 ... 
    ##    50         0.6979    0.022 0.147 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3387    0.100 0.081 0.819 ... 
    ##    70         0.2179    0.022 0.158 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1240    0.066 0.054 0.337 ... 
    ##    90         0.0902    0.022 0.167 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0956    0.069 0.056 0.310 ... 
    ##   110         0.1126    0.022 0.174 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1071    0.071 0.058 0.293 ... 
    ##   130         0.0808    0.022 0.179 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0645    0.072 0.059 0.282 ... 
    ##   150         0.0588    0.022 0.184 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0592    0.072 0.059 0.280 ... 
    ##   170         0.0639    0.022 0.188 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0696    0.072 0.059 0.280 ... 
    ##   190         0.0706    0.023 0.192 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0638    0.072 0.058 0.281 ... 
    ##   210         0.0550    0.023 0.194 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0538    0.072 0.059 0.280 ... 
    ##   230         0.0693    0.023 0.193 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.1140    0.064 0.052 0.114 ... 
    ##   250         0.1372    0.023 0.190 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0672    0.067 0.054 0.085 ... 
    ##   270         0.0290    0.023 0.185 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0142    0.068 0.055 0.070 ... 
    ##   287         0.0099
    ## timing iterateEM: 5.367 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        17.3741    0.010 0.052 0.043 ... 
    ## [1] "Removing overlaps!"
    ##    20         9.1796    0.088 0.912 0.000 ... 
    ##    30        12.6736    0.012 0.047 0.023 ... 
    ## [1] "Removing overlaps!"
    ##    40         4.5425    0.045 0.130 0.825 ... 
    ##    50         0.1275    0.010 0.053 0.015 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1052    0.045 0.130 0.824 ... 
    ##    70         0.0930    0.010 0.054 0.015 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0514    0.046 0.129 0.825 ... 
    ##    90         0.0482    0.010 0.055 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0569    0.046 0.129 0.826 ... 
    ##   110         0.0876    0.010 0.056 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2345    0.046 0.128 0.827 ... 
    ##   130         1.2243    0.010 0.058 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.9919    0.046 0.125 0.830 ... 
    ##   150         0.2999    0.010 0.054 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.5290    0.046 0.118 0.836 ... 
    ##   170         0.2773    0.010 0.045 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   180        13.4706    0.040 0.166 0.073 ... 
    ##   190         0.4630    0.010 0.039 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.1204    0.024 0.092 0.403 ... 
    ##   210         0.0636    0.010 0.038 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0401    0.024 0.088 0.419 ... 
    ##   230         0.0253    0.010 0.037 0.015 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0156    0.023 0.087 0.428 ... 
    ##   250         0.0095    0.010 0.037 0.015 ... 
    ##   251         0.0095
    ## timing iterateEM: 4.87 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        19.6343    0.010 0.102 0.055 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.5843    0.095 0.186 0.719 ... 
    ##    30         1.3264    0.025 0.098 0.045 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6622    0.101 0.136 0.763 ... 
    ##    50         0.9522    0.024 0.098 0.040 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.6071    0.088 0.127 0.116 ... 
    ##    70         0.5130    0.024 0.098 0.030 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5743    0.092 0.091 0.116 ... 
    ##    90         0.7335    0.025 0.103 0.019 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.9829    0.100 0.051 0.108 ... 
    ##   110         6.6922    0.025 0.113 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2418    0.102 0.052 0.084 ... 
    ##   130         0.0858    0.025 0.120 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0397    0.074 0.038 0.273 ... 
    ##   150         0.0596    0.025 0.123 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0538    0.075 0.039 0.264 ... 
    ##   170         0.0278    0.025 0.127 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0192    0.076 0.039 0.260 ... 
    ##   190         0.0141    0.025 0.129 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0099    0.076 0.039 0.259 ... 
    ##   201         0.0099
    ## timing iterateEM: 4.078 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        24.0250    0.010 0.130 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    20         9.8472    0.078 0.171 0.751 ... 
    ##    30         2.4259    0.010 0.119 0.065 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.4380    0.026 0.101 0.064 ... 
    ##    50         0.5367    0.010 0.139 0.073 ... 
    ## [1] "Removing overlaps!"
    ##    60         9.8942    0.027 0.106 0.051 ... 
    ##    70         0.5180    0.010 0.138 0.097 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.8312    0.045 0.179 0.080 ... 
    ##    90         0.6978    0.010 0.125 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2713    0.026 0.102 0.045 ... 
    ##   110         0.1559    0.010 0.118 0.097 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1288    0.045 0.179 0.080 ... 
    ##   130         4.8754    0.010 0.119 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1210    0.045 0.179 0.079 ... 
    ##   150         0.0624    0.010 0.121 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0589    0.045 0.179 0.079 ... 
    ##   170         0.1824    0.010 0.120 0.101 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.7248    0.045 0.176 0.078 ... 
    ##   190         0.0557    0.010 0.116 0.105 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0421    0.045 0.177 0.078 ... 
    ##   210         0.0290    0.010 0.110 0.107 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0194    0.045 0.177 0.078 ... 
    ##   230         0.0136    0.010 0.104 0.108 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0105    0.020 0.200 0.078 ... 
    ##   244         0.0098
    ## timing iterateEM: 4.913 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        32.8381    0.010 0.112 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.0542    0.109 0.224 0.667 ... 
    ##    30         5.1261    0.022 0.129 0.047 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.6297    0.124 0.159 0.717 ... 
    ##    50         0.8308    0.023 0.123 0.058 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2651    0.124 0.155 0.721 ... 
    ##    70         0.1980    0.022 0.117 0.062 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2788    0.107 0.128 0.148 ... 
    ##    90         0.5703    0.023 0.119 0.061 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.9990    0.114 0.134 0.091 ... 
    ##   110         5.1549    0.022 0.119 0.054 ... 
    ## [1] "Removing overlaps!"
    ##   120         7.0923    0.058 0.064 0.414 ... 
    ##   130         0.2730    0.018 0.111 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1672    0.098 0.120 0.040 ... 
    ##   150         0.1027    0.017 0.113 0.030 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0697    0.097 0.120 0.040 ... 
    ##   170         0.0651    0.017 0.108 0.023 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0962    0.096 0.118 0.040 ... 
    ##   190         0.1652    0.016 0.101 0.017 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.9693    0.084 0.117 0.041 ... 
    ##   210         0.0643    0.010 0.088 0.019 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0262    0.060 0.119 0.042 ... 
    ##   230         0.0184    0.010 0.076 0.018 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0099    0.060 0.119 0.042 ... 
    ##   241         0.0099
    ## timing iterateEM: 4.526 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        31.8231    0.010 0.049 0.013 ... 
    ## [1] "Removing overlaps!"
    ##    20        15.1216    0.041 0.117 0.028 ... 
    ##    30         1.6309    0.010 0.020 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.6819    0.043 0.083 0.030 ... 
    ##    50         1.1835    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4042    0.043 0.083 0.030 ... 
    ##    70         0.1895    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1244    0.043 0.083 0.030 ... 
    ##    90         0.0839    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0606    0.043 0.083 0.030 ... 
    ##   110         0.0481    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0405    0.043 0.083 0.030 ... 
    ##   130         0.0353    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0318    0.043 0.083 0.030 ... 
    ##   150         0.0296    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0284    0.043 0.083 0.030 ... 
    ##   170         0.0283    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0289    0.043 0.083 0.030 ... 
    ##   190         0.0293    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0281    0.043 0.083 0.030 ... 
    ##   210         0.0245    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0196    0.043 0.083 0.030 ... 
    ##   230         0.0152    0.010 0.019 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0123    0.030 0.059 0.021 ... 
    ##   250         0.0106    0.010 0.019 0.012 ... 
    ##   258         0.0099
    ## timing iterateEM: 6.28 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        50.5585    0.010 0.130 0.021 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.8041    0.070 0.930 0.000 ... 
    ##    30         1.1575    0.010 0.163 0.014 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.5066    0.070 0.930 0.000 ... 
    ##    50         2.5839    0.010 0.179 0.014 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.1018    0.057 0.081 0.765 ... 
    ##    70         0.7785    0.010 0.164 0.014 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.3412    0.058 0.073 0.768 ... 
    ##    90         0.1848    0.010 0.163 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1572    0.058 0.071 0.770 ... 
    ##   110         0.1525    0.010 0.166 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1052    0.058 0.066 0.056 ... 
    ##   130         2.7106    0.010 0.167 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1043    0.058 0.067 0.069 ... 
    ##   150         0.1216    0.010 0.166 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.1590    0.058 0.069 0.068 ... 
    ##   170         0.2064    0.010 0.160 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.2290    0.033 0.425 0.040 ... 
    ##   190         0.2057    0.010 0.145 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.1590    0.035 0.385 0.044 ... 
    ##   210         0.1060    0.010 0.126 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0609    0.037 0.363 0.047 ... 
    ##   230         0.0321    0.010 0.113 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0169    0.037 0.353 0.049 ... 
    ##   250         0.0099
    ## timing iterateEM: 5.355 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        48.9062    0.010 0.032 0.152 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.0890    0.049 0.951 0.000 ... 
    ##    30         4.3316    0.010 0.016 0.151 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.9166    0.042 0.037 0.116 ... 
    ##    50         0.2611    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.7124    0.043 0.027 0.100 ... 
    ##    70         0.7686    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.7036    0.044 0.027 0.083 ... 
    ##    90         0.8952    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.6781    0.044 0.027 0.078 ... 
    ##   110         0.3960    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1224    0.044 0.027 0.073 ... 
    ##   130         0.0898    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0795    0.044 0.027 0.073 ... 
    ##   150         0.0806    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.1122    0.044 0.027 0.073 ... 
    ##   170         1.1213    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1125    0.044 0.027 0.077 ... 
    ##   190         0.0245    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0177    0.044 0.027 0.078 ... 
    ##   210         0.0143    0.010 0.006 0.151 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0117    0.044 0.027 0.078 ... 
    ##   230         0.0101    0.010 0.006 0.151 ... 
    ##   233         0.0099
    ## timing iterateEM: 5.561 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        44.2906    0.010 0.109 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    20        19.4630    0.073 0.927 0.000 ... 
    ##    30         2.8748    0.010 0.095 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.0281    0.055 0.945 0.000 ... 
    ##    50         0.9700    0.010 0.095 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2236    0.055 0.945 0.000 ... 
    ##    70         0.1221    0.010 0.106 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1061    0.055 0.945 0.000 ... 
    ##    90         0.1160    0.010 0.120 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1251    0.055 0.945 0.000 ... 
    ##   110         0.1208    0.010 0.138 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1063    0.055 0.945 0.000 ... 
    ##   130         0.0917    0.010 0.154 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0852    0.036 0.350 0.614 ... 
    ##   150         0.0899    0.010 0.169 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0989    0.037 0.322 0.640 ... 
    ##   170         0.0999    0.010 0.184 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0936    0.039 0.298 0.663 ... 
    ##   190         0.0860    0.010 0.199 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0781    0.040 0.275 0.685 ... 
    ##   210         0.0692    0.010 0.215 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0597    0.041 0.254 0.705 ... 
    ##   230         0.0504    0.010 0.229 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0420    0.031 0.269 0.173 ... 
    ##   250         0.0344    0.010 0.240 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0274    0.029 0.243 0.153 ... 
    ##   270         0.0213    0.010 0.248 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0161    0.029 0.240 0.149 ... 
    ##   290         0.0123    0.010 0.255 0.133 ... 
    ##   300         0.0099
    ## timing iterateEM: 8.463 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        20.9447    0.010 0.020 0.098 ... 
    ## [1] "Removing overlaps!"
    ##    20        48.8587    0.048 0.117 0.836 ... 
    ##    30         3.1971    0.010 0.038 0.117 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.2349    0.046 0.080 0.874 ... 
    ##    50         1.8725    0.010 0.038 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.7281    0.046 0.080 0.874 ... 
    ##    70         0.3083    0.010 0.038 0.128 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1843    0.043 0.076 0.023 ... 
    ##    90         0.0975    0.010 0.038 0.128 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0633    0.043 0.076 0.021 ... 
    ##   110         0.0469    0.010 0.038 0.131 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0410    0.027 0.048 0.013 ... 
    ##   130         0.0384    0.010 0.038 0.132 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0343    0.028 0.049 0.013 ... 
    ##   150         0.0371    0.010 0.038 0.133 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0732    0.028 0.049 0.013 ... 
    ##   170         0.2376    0.010 0.038 0.136 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.2753    0.028 0.049 0.011 ... 
    ##   190         1.1189    0.010 0.038 0.140 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0339    0.029 0.048 0.010 ... 
    ##   210         0.0395    0.010 0.038 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0338    0.029 0.048 0.010 ... 
    ##   230         0.0206    0.010 0.038 0.142 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0130    0.029 0.048 0.010 ... 
    ##   248         0.0099
    ## timing iterateEM: 7.128 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        19.4344    0.010 0.087 0.078 ... 
    ## [1] "Removing overlaps!"
    ##    20        36.7805    0.063 0.937 0.000 ... 
    ##    30         0.8247    0.010 0.087 0.079 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.8499    0.063 0.937 0.000 ... 
    ##    50         0.6758    0.010 0.094 0.084 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.7152    0.033 0.380 0.098 ... 
    ##    70         0.5358    0.010 0.096 0.085 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1517    0.033 0.390 0.078 ... 
    ##    90         0.0894    0.010 0.095 0.085 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1018    0.033 0.397 0.074 ... 
    ##   110         0.8719    0.010 0.092 0.086 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1633    0.033 0.408 0.063 ... 
    ##   130         0.1101    0.010 0.076 0.091 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0757    0.030 0.377 0.056 ... 
    ##   150         0.0518    0.010 0.068 0.093 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0362    0.030 0.387 0.055 ... 
    ##   170         0.0278    0.010 0.064 0.093 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0260    0.030 0.393 0.055 ... 
    ##   190         0.0303    0.010 0.063 0.090 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0409    0.030 0.396 0.055 ... 
    ##   210         0.0586    0.010 0.063 0.084 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0829    0.030 0.395 0.055 ... 
    ##   230         0.1087    0.010 0.063 0.074 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.1187    0.030 0.392 0.055 ... 
    ##   250         0.1061    0.010 0.062 0.064 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.1084    0.030 0.394 0.055 ... 
    ##   270         0.1737    0.010 0.056 0.057 ... 
    ## [1] "Removing overlaps!"
    ##   280         3.1094    0.031 0.406 0.045 ... 
    ##   290         0.2174    0.010 0.043 0.051 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.2082    0.031 0.417 0.041 ... 
    ##   310         0.0840    0.010 0.032 0.045 ... 
    ## [1] "Removing overlaps!"
    ##   320         0.0498    0.031 0.423 0.041 ... 
    ##   330         0.0852    0.010 0.029 0.038 ... 
    ## [1] "Removing overlaps!"
    ##   340         0.9180    0.032 0.429 0.042 ... 
    ##   350         0.0217    0.010 0.029 0.032 ... 
    ## [1] "Removing overlaps!"
    ##   360         0.0272    0.032 0.432 0.042 ... 
    ##   370         0.0399    0.010 0.029 0.025 ... 
    ## [1] "Removing overlaps!"
    ##   380         0.0492    0.032 0.431 0.042 ... 
    ##   390         0.0432    0.010 0.029 0.018 ... 
    ## [1] "Removing overlaps!"
    ##   400         0.0319    0.032 0.431 0.042 ... 
    ##   410         0.0237    0.010 0.028 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   420         0.0162    0.032 0.430 0.042 ... 
    ##   430         0.0167    0.010 0.028 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   440         0.0580    0.032 0.429 0.042 ... 
    ##   450         0.0701    0.010 0.028 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   460         0.0307    0.056 0.073 0.031 ... 
    ##   470         0.0248    0.010 0.028 0.019 ... 
    ## [1] "Removing overlaps!"
    ##   480         0.0202    0.056 0.073 0.031 ... 
    ##   490         0.0150    0.010 0.028 0.024 ... 
    ## [1] "Removing overlaps!"
    ##   500         0.0104    0.056 0.073 0.031 ... 
    ##   503         0.0097
    ## timing iterateEM: 11.5 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        53.0783    0.010 0.106 0.057 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.5942    0.091 0.909 0.000 ... 
    ##    30         4.1437    0.019 0.118 0.042 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.7024    0.084 0.104 0.812 ... 
    ##    50         1.8417    0.021 0.126 0.042 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2088    0.088 0.102 0.810 ... 
    ##    70         0.1744    0.021 0.122 0.042 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2557    0.090 0.102 0.809 ... 
    ##    90         0.3016    0.022 0.120 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2370    0.091 0.102 0.807 ... 
    ##   110         0.2906    0.022 0.120 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2893    0.092 0.102 0.806 ... 
    ##   130         0.1841    0.022 0.123 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1194    0.091 0.102 0.807 ... 
    ##   150         0.0956    0.022 0.124 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0897    0.077 0.087 0.150 ... 
    ##   170         0.0890    0.022 0.123 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0759    0.077 0.087 0.148 ... 
    ##   190         0.0598    0.021 0.120 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0512    0.076 0.087 0.147 ... 
    ##   210         0.0482    0.021 0.117 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0482    0.076 0.087 0.148 ... 
    ##   230         0.0484    0.021 0.115 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0463    0.054 0.289 0.062 ... 
    ##   250         0.0406    0.021 0.113 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0323    0.054 0.286 0.062 ... 
    ##   270         0.0237    0.021 0.112 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0168    0.076 0.087 0.148 ... 
    ##   290         0.0118    0.021 0.111 0.042 ... 
    ##   296         0.0100
    ## timing iterateEM: 8.859 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        24.6843    0.010 0.091 0.014 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.1977    0.052 0.018 0.223 ... 
    ##    30        10.3404    0.021 0.099 0.014 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.0655    0.112 0.026 0.169 ... 
    ##    50         1.7918    0.023 0.103 0.018 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.1085    0.112 0.030 0.168 ... 
    ##    70         1.8585    0.023 0.102 0.011 ... 
    ## [1] "Removing overlaps!"
    ##    80         4.2063    0.110 0.038 0.027 ... 
    ##    90         0.2288    0.024 0.094 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.6083    0.113 0.030 0.026 ... 
    ##   110         9.2459    0.024 0.093 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0839    0.106 0.028 0.023 ... 
    ##   130         0.0246    0.025 0.091 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0120    0.106 0.028 0.022 ... 
    ##   145         0.0097
    ## timing iterateEM: 3.748 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        29.2394    0.010 0.057 0.069 ... 
    ## [1] "Removing overlaps!"
    ##    20        12.0776    0.060 0.118 0.822 ... 
    ##    30         4.9658    0.010 0.048 0.076 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.7973    0.036 0.170 0.067 ... 
    ##    50         1.0766    0.010 0.046 0.078 ... 
    ## [1] "Removing overlaps!"
    ##    60         3.7025    0.037 0.164 0.066 ... 
    ##    70         0.4531    0.010 0.042 0.077 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2906    0.038 0.145 0.067 ... 
    ##    90         0.2635    0.010 0.036 0.083 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2132    0.038 0.132 0.069 ... 
    ##   110         0.2169    0.010 0.033 0.088 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2429    0.039 0.122 0.069 ... 
    ##   130         0.2175    0.010 0.030 0.085 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1888    0.039 0.110 0.070 ... 
    ##   150         0.2539    0.010 0.025 0.086 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.8274    0.040 0.079 0.073 ... 
    ##   170         2.0261    0.010 0.012 0.089 ... 
    ## [1] "Removing overlaps!"
    ##   180         4.8396    0.043 0.030 0.077 ... 
    ##   190         0.0832    0.010 0.007 0.095 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0482    0.043 0.028 0.078 ... 
    ##   210         0.0307    0.010 0.007 0.101 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0225    0.043 0.028 0.078 ... 
    ##   230         0.0210    0.010 0.007 0.106 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0219    0.037 0.024 0.135 ... 
    ##   250         0.0227    0.010 0.007 0.112 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0226    0.037 0.024 0.133 ... 
    ##   270         0.0214    0.010 0.007 0.117 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0188    0.037 0.024 0.132 ... 
    ##   290         0.0151    0.010 0.007 0.122 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.0107    0.037 0.024 0.131 ... 
    ##   303         0.0098
    ## timing iterateEM: 9.843 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        22.9813    0.013 0.145 0.044 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.1059    0.151 0.849 0.000 ... 
    ##    30         1.8817    0.026 0.144 0.048 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5642    0.149 0.851 0.000 ... 
    ##    50         0.4769    0.025 0.144 0.048 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3751    0.149 0.851 0.000 ... 
    ##    70         0.3200    0.026 0.144 0.051 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.4533    0.150 0.850 0.000 ... 
    ##    90         0.5826    0.026 0.144 0.052 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.5333    0.151 0.849 0.000 ... 
    ##   110         0.3370    0.026 0.144 0.053 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2727    0.152 0.848 0.000 ... 
    ##   130         0.2754    0.026 0.144 0.054 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2768    0.153 0.847 0.000 ... 
    ##   150         0.3621    0.026 0.144 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.8955    0.135 0.113 0.752 ... 
    ##   170         0.7883    0.026 0.144 0.056 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1365    0.141 0.078 0.781 ... 
    ##   190         0.1823    0.026 0.144 0.056 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0859    0.123 0.129 0.067 ... 
    ##   210         0.0658    0.026 0.144 0.056 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0635    0.125 0.116 0.068 ... 
    ##   230         0.0680    0.026 0.144 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0769    0.126 0.110 0.069 ... 
    ##   250         0.0770    0.026 0.144 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0576    0.109 0.060 0.604 ... 
    ##   270         0.0371    0.026 0.144 0.056 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0249    0.112 0.061 0.620 ... 
    ##   290         0.0178    0.026 0.144 0.056 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.0133    0.113 0.062 0.628 ... 
    ##   310         0.0100    0.026 0.144 0.057 ... 
    ##   312         0.0098
    ## timing iterateEM: 11.007 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        33.9397    0.010 0.093 0.021 ... 
    ## [1] "Removing overlaps!"
    ##    20        27.8194    0.053 0.947 0.000 ... 
    ##    30         2.6385    0.010 0.101 0.019 ... 
    ## [1] "Removing overlaps!"
    ##    40         5.3165    0.035 0.067 0.106 ... 
    ##    50         0.9968    0.010 0.085 0.018 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.2170    0.038 0.065 0.094 ... 
    ##    70         8.4254    0.010 0.072 0.016 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5483    0.041 0.073 0.054 ... 
    ##    90         0.5376    0.010 0.062 0.016 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3395    0.042 0.059 0.056 ... 
    ##   110         0.2210    0.010 0.049 0.012 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1150    0.043 0.047 0.053 ... 
    ##   130         0.2484    0.010 0.044 0.010 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.3957    0.043 0.048 0.034 ... 
    ##   150         0.1064    0.010 0.042 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.3610    0.044 0.057 0.015 ... 
    ##   170         2.2973    0.010 0.040 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0131    0.044 0.058 0.022 ... 
    ##   183         0.0089
    ## timing iterateEM: 6.209 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        58.0395    0.010 0.013 0.091 ... 
    ## [1] "Removing overlaps!"
    ##    20         7.9228    0.053 0.026 0.014 ... 
    ##    30         3.7297    0.010 0.005 0.077 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.3133    0.046 0.020 0.012 ... 
    ##    50         0.1801    0.010 0.004 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1178    0.048 0.017 0.013 ... 
    ##    70         0.1048    0.010 0.004 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0717    0.048 0.017 0.013 ... 
    ##    90         0.0631    0.010 0.004 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0746    0.048 0.017 0.013 ... 
    ##   110         0.1202    0.010 0.003 0.073 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.0363    0.049 0.017 0.013 ... 
    ##   130         0.3614    0.010 0.003 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2038    0.050 0.017 0.013 ... 
    ##   150         0.1467    0.010 0.003 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0915    0.050 0.017 0.013 ... 
    ##   170         0.0937    0.010 0.003 0.073 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1362    0.050 0.016 0.013 ... 
    ##   190         0.2771    0.010 0.003 0.072 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0664    0.047 0.016 0.012 ... 
    ##   210         0.0140    0.010 0.003 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0100    0.048 0.016 0.012 ... 
    ##   221         0.0100
    ## timing iterateEM: 5.447 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        72.7256    0.010 0.068 0.013 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.4524    0.067 0.933 0.000 ... 
    ##    30         1.3014    0.010 0.053 0.011 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.1976    0.059 0.039 0.902 ... 
    ##    50         3.6858    0.010 0.031 0.011 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.7430    0.052 0.130 0.034 ... 
    ##    70         0.4131    0.010 0.024 0.011 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.3150    0.037 0.085 0.024 ... 
    ##    90         0.9307    0.010 0.021 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3852    0.039 0.080 0.025 ... 
    ##   110         0.3440    0.010 0.020 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.9997    0.035 0.063 0.023 ... 
    ##   130         0.3746    0.010 0.016 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2975    0.036 0.058 0.024 ... 
    ##   150         2.1969    0.010 0.016 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2164    0.037 0.058 0.024 ... 
    ##   170         0.1377    0.010 0.016 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1633    0.037 0.059 0.024 ... 
    ##   190         0.0421    0.010 0.016 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0138    0.038 0.060 0.025 ... 
    ##   208         0.0100
    ## timing iterateEM: 4.986 sec elapsed
    ## sampled subset EM: 237.918 sec elapsed
    ## full calculation with 11 clusters, idx 7
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        16.5715    0.025 0.140 0.129 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.4468    0.077 0.122 0.054 ... 
    ##    30         1.9609    0.025 0.137 0.129 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.1213    0.085 0.060 0.376 ... 
    ##    50         0.7175    0.025 0.135 0.129 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4820    0.084 0.059 0.383 ... 
    ##    70         0.3333    0.025 0.133 0.129 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2361    0.083 0.058 0.388 ... 
    ##    90         0.1712    0.025 0.132 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1269    0.083 0.058 0.390 ... 
    ##   110         0.0959    0.025 0.132 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0738    0.083 0.058 0.392 ... 
    ##   130         0.0577    0.025 0.131 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0456    0.083 0.058 0.393 ... 
    ##   150         0.0365    0.025 0.131 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0295    0.083 0.058 0.393 ... 
    ##   170         0.0240    0.025 0.130 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0197    0.083 0.058 0.393 ... 
    ##   190         0.0163    0.025 0.130 0.129 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0135    0.083 0.058 0.393 ... 
    ##   210         0.0113    0.025 0.130 0.129 ... 
    ##   218         0.0099
    ## timing iterateEM: 68.628 sec elapsed
    ## full calculation with 12 clusters, idx 8
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        42.7449    0.023 0.024 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    20        30.6157    0.126 0.098 0.775 ... 
    ##    30        17.1919    0.023 0.026 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    40         6.3321    0.127 0.098 0.775 ... 
    ##    50         2.6416    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.3993    0.127 0.098 0.774 ... 
    ##    70         0.8715    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.6152    0.127 0.098 0.774 ... 
    ##    90         0.4991    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.4729    0.128 0.098 0.774 ... 
    ##   110         0.5141    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.6122    0.128 0.098 0.774 ... 
    ##   130         0.7604    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.9478    0.128 0.098 0.774 ... 
    ##   150         1.1536    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   160         1.3465    0.127 0.098 0.774 ... 
    ##   170         1.4940    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   180         1.5772    0.127 0.098 0.774 ... 
    ##   190         1.5978    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   200         1.5720    0.127 0.098 0.774 ... 
    ##   210         1.5184    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   220         1.4513    0.127 0.098 0.774 ... 
    ##   230         1.3803    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   240         1.3123    0.127 0.098 0.774 ... 
    ##   250         1.2529    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   260         1.2081    0.065 0.050 0.489 ... 
    ##   270         1.1844    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   280         1.1897    0.058 0.102 0.045 ... 
    ##   290         1.2342    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   300         1.3324    0.058 0.095 0.045 ... 
    ##   310         1.5073    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   320         1.7984    0.058 0.087 0.045 ... 
    ##   330         2.2797    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   340         3.1074    0.058 0.078 0.045 ... 
    ##   350         4.6724    0.023 0.028 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   360         8.2186    0.058 0.066 0.045 ... 
    ##   370        18.7243    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   380        44.6738    0.059 0.045 0.046 ... 
    ##   390        35.7951    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   400       112.7762    0.060 0.024 0.046 ... 
    ##   410         3.6674    0.023 0.026 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   420         1.2337    0.061 0.016 0.046 ... 
    ##   430         0.4696    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   440         0.1775    0.061 0.016 0.046 ... 
    ##   450         0.0671    0.023 0.027 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   460         0.0257    0.061 0.016 0.047 ... 
    ##   470         0.0101    0.023 0.027 0.110 ... 
    ##   472         0.0092
    ## timing iterateEM: 151.876 sec elapsed
    ## full calculation with 13 clusters, idx 9
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        34.5931    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##    20        26.5980    0.046 0.028 0.082 ... 
    ##    30        32.4709    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##    40        40.1314    0.046 0.028 0.082 ... 
    ##    50        45.4668    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##    60        49.6021    0.046 0.028 0.082 ... 
    ##    70        42.1634    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##    80        24.9906    0.046 0.028 0.082 ... 
    ##    90         5.9808    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   100         5.3589    0.046 0.028 0.082 ... 
    ##   110         2.7683    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.6321    0.046 0.028 0.082 ... 
    ##   130         1.0448    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.6909    0.046 0.028 0.082 ... 
    ##   150         0.4574    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2962    0.046 0.028 0.082 ... 
    ##   170         0.1836    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.1060    0.046 0.028 0.082 ... 
    ##   190         0.0542    0.010 0.006 0.141 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0211    0.046 0.028 0.082 ... 
    ##   206         0.0098
    ## timing iterateEM: 80.289 sec elapsed
    ## full calculation with 14 clusters, idx 10
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        18.6016    0.010 0.043 0.137 ... 
    ## [1] "Removing overlaps!"
    ##    20        69.0040    0.045 0.077 0.035 ... 
    ##    30        24.0923    0.010 0.043 0.127 ... 
    ## [1] "Removing overlaps!"
    ##    40         4.9177    0.043 0.074 0.020 ... 
    ##    50         2.4645    0.010 0.043 0.120 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.4159    0.028 0.049 0.013 ... 
    ##    70         1.1024    0.010 0.043 0.114 ... 
    ## [1] "Removing overlaps!"
    ##    80         1.0014    0.030 0.051 0.014 ... 
    ##    90         0.9484    0.010 0.043 0.110 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.9460    0.030 0.051 0.014 ... 
    ##   110         1.0532    0.010 0.043 0.108 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.3561    0.030 0.052 0.014 ... 
    ##   130         1.9744    0.010 0.043 0.106 ... 
    ## [1] "Removing overlaps!"
    ##   140         2.8947    0.030 0.052 0.014 ... 
    ##   150         3.5648    0.010 0.043 0.104 ... 
    ## [1] "Removing overlaps!"
    ##   160         3.9746    0.030 0.052 0.014 ... 
    ##   170         4.8614    0.010 0.043 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   180         5.1165    0.030 0.052 0.014 ... 
    ##   190         4.6716    0.010 0.043 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   200         5.4461    0.030 0.053 0.014 ... 
    ##   210         8.6965    0.010 0.043 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   220        17.9621    0.030 0.054 0.013 ... 
    ##   230        60.0270    0.010 0.043 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   240        54.0532    0.029 0.052 0.013 ... 
    ##   250        37.0620    0.010 0.043 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   260       304.1805    0.029 0.052 0.013 ... 
    ##   270         5.3901    0.010 0.043 0.102 ... 
    ## [1] "Removing overlaps!"
    ##   280         3.8573    0.029 0.051 0.013 ... 
    ##   290         3.5118    0.010 0.043 0.101 ... 
    ## [1] "Removing overlaps!"
    ##   300         3.1059    0.029 0.051 0.013 ... 
    ##   310         2.5245    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   320         1.8754    0.029 0.052 0.013 ... 
    ##   330         1.2983    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   340         0.8648    0.029 0.052 0.013 ... 
    ##   350         0.5672    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   360         0.3737    0.029 0.053 0.013 ... 
    ##   370         0.2539    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   380         0.1817    0.029 0.053 0.013 ... 
    ##   390         0.1375    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   400         0.1091    0.030 0.053 0.013 ... 
    ##   410         0.0897    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   420         0.0760    0.030 0.053 0.013 ... 
    ##   430         0.0660    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   440         0.0587    0.030 0.053 0.013 ... 
    ##   450         0.0534    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   460         0.0498    0.030 0.053 0.013 ... 
    ##   470         0.0477    0.010 0.043 0.098 ... 
    ## [1] "Removing overlaps!"
    ##   480         0.0469    0.030 0.053 0.013 ... 
    ##   490         0.0475    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   500         0.0500    0.030 0.053 0.014 ... 
    ##   510         0.0550    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   520         0.0637    0.030 0.053 0.014 ... 
    ##   530         0.0791    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   540         0.1072    0.030 0.053 0.014 ... 
    ##   550         0.1630    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   560         0.2881    0.030 0.053 0.014 ... 
    ##   570         0.6137    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   580         1.5390    0.030 0.053 0.014 ... 
    ##   590         3.2579    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   600         2.5404    0.030 0.053 0.013 ... 
    ##   610         0.7050    0.010 0.043 0.099 ... 
    ## [1] "Removing overlaps!"
    ##   620         0.1885    0.030 0.053 0.013 ... 
    ##   630         0.0759    0.010 0.043 0.100 ... 
    ## [1] "Removing overlaps!"
    ##   640         0.0366    0.030 0.053 0.013 ... 
    ##   650         0.0153    0.010 0.043 0.100 ... 
    ##   655         0.0094
    ## timing iterateEM: 262.536 sec elapsed
    ## full calculation with 15 clusters, idx 11
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10       131.8391    0.010 0.006 0.122 ... 
    ## [1] "Removing overlaps!"
    ##    20        15.1367    0.045 0.027 0.080 ... 
    ##    30         9.2880    0.010 0.006 0.100 ... 
    ## [1] "Removing overlaps!"
    ##    40         5.5576    0.045 0.027 0.080 ... 
    ##    50         3.3252    0.010 0.006 0.088 ... 
    ## [1] "Removing overlaps!"
    ##    60         2.0615    0.045 0.027 0.081 ... 
    ##    70         1.3382    0.010 0.006 0.082 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.9043    0.045 0.027 0.081 ... 
    ##    90         0.6303    0.010 0.006 0.078 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.4496    0.045 0.027 0.081 ... 
    ##   110         0.3265    0.010 0.006 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2405    0.045 0.027 0.081 ... 
    ##   130         0.1793    0.010 0.006 0.074 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1348    0.045 0.027 0.081 ... 
    ##   150         0.1020    0.010 0.006 0.073 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0775    0.045 0.027 0.081 ... 
    ##   170         0.0589    0.010 0.006 0.072 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0447    0.030 0.018 0.330 ... 
    ##   190         0.0336    0.010 0.006 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0250    0.030 0.018 0.329 ... 
    ##   210         0.0181    0.010 0.006 0.071 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0127    0.030 0.018 0.329 ... 
    ##   227         0.0099
    ## timing iterateEM: 90.899 sec elapsed
    ## full EM run on best subset of clusters: 668.555 sec elapsed

``` r
pic <- plotDensityAndEllipses(fcsData = test1, ch1="PMT.1", ch2="PMT.9", alpha=0.9,
                                 logScale = F, results = gating_test1$best,
                                 ellipseDotSize = 0.5, axis_size=10, axisLabeling_size=10,
                                 xlab = "Forward Scatter", ylab = "DAPI", font = "Arial")
```

    ## Warning in KernSmooth::bkde2D(x, bandwidth = bandwidth, gridsize = nbin, :
    ## Binning grid too coarse for current (small) bandwidth: consider increasing
    ## 'gridsize'

![](02b-flowmix-on-microbial-community-data_files/figure-gfm/test-1.png)<!-- -->

### flowmix

First, all fcs datas need to be converted to the flowmix required format
for downstream analysis.

FSC and DAPI fluorescence would be the features for the cytograms, and
environmental variables come from the abiotic sheet.

``` r
# cytograms
C1_ylist <- list()

for (i in seq_along(C1_data)){
  C1_ylist[[i]] <- C1_data[[i]]@exprs[,c(11,13,27)] # PMT.1/2 for FSC/SSC, PMT.9 for fluorescence
}

# environment variables
abio_data <- read_excel("~/Desktop/osfstorage/Data sheet for abiotic parameters.xlsx")
C1_X <- abio_data[abio_data$Reactor=="C1",4:11]
C1_X[is.na(C1_X)] <- 0
C1_X <- as.matrix(C1_X)
```

Notation: since in the original data, each time point contains over 200k
cells, here I select 10k for each as subset for illustration. The
results for whole dataset comes later.

``` r
# binning data
set.seed(0)
ysub <- list()

for (i in 1:65) {
  rrow <- sample(1:200000,size=2000,replace = F)
  ysub[[i]] <- C1_ylist[[i]][rrow,]
  ysub[[i]][,] <- as.double(ysub[[i]][,])
}

grid <- make_grid(ysub,gridsize = 30)
obj <- bin_many_cytograms(ysub,grid,mc.cores = 4,verbose = F)
sub_ylist <- obj$ybin_list
sub_countslist <- obj$counts_list
```

### on-going

Havn’t got the results for flowmix, but all required data have been
prepared

``` r
# flowmix for 2d
set.seed(0)
sub_rest <- flowmix(sub_ylist,C1_X,
                   countslist=sub_countslist,numclust=5,
                   mean_lambda=0.001,prob_lambda=0.001,
                   verbose=F,maxdev=0.5)
```

## Task2

``` r
folder_path <- "~/Desktop/FlowRepo/"
file_name <- list.files(folder_path,pattern = "\\.fcs$",full.names = T)
MoFloA_Feb_data <- list()
MoFloA_Mar_data <- list()
MoFloA_Nov_data <- list()
MoFloA_Dec_data <- list()

# Group files by the month

for (file_name in file_name){
  month <- substr(file_name,start = 46,stop = 48) # use nchar to locate
  new_name <- substr(file_name,start = 43, stop = 58)
  data <- read.FCS(file_name,alter.names = T,transformation=F)
  if (month=="Feb") { MoFloA_Feb_data[[new_name]] <- data}
  else if (month=="Mar") {MoFloA_Mar_data[[new_name]] <- data}
  else if (month=="Nov") {MoFloA_Nov_data[[new_name]] <- data}
  else if (month=="Dec") {MoFloA_Dec_data[[new_name]] <- data}
}
```

### flowEMMI v2

``` r
test <- MoFloA_Nov_data[[1]]

# FL4 is the signal channel
fdo_test <- mkFlowDataObject(test, xChannel="FS.Log", yChannel="FL.4.Log")

set.seed(1)
gating_test <- flowEMMi( fdo=fdo_test
                       , xMin=1, xMax=5000, yMin=1, yMax=5000
                       , initFraction=0.01
                       , finalFraction=1.0
                       , minClusters=5, maxClusters=15, clusterbracket=2
                       , numberOfInits=5
                       , verbose=TRUE
                       , parallel=FALSE
                       , convergenceEpsilon=0.01
                       , whenToRemoveOverlaps = 20
                       , mergeWhenCenter = FALSE
                       , mergeWhenTwoCenters = FALSE
                       , thresholdForDeletion = 0.2
                       , threshold = 0.9
                       , considerWeights=TRUE
                       , plot = FALSE
                       , alpha=0.9
                       , minMinor=500
)
```

    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10        47.4345    0.010 0.211 0.182 ... 
    ## [1] "Removing overlaps!"
    ##    20        26.8736    0.012 0.443 0.545 ... 
    ##    30         6.6632    0.010 0.171 0.265 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.6599    0.015 0.480 0.505 ... 
    ##    50         2.4395    0.010 0.051 0.292 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1426    0.015 0.460 0.525 ... 
    ##    70         0.0080    0.010 0.069 0.266 ... 
    ##    71         0.0080
    ## timing iterateEM: 0.738 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10         4.8379    0.010 0.130 0.228 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.7084    0.015 0.456 0.528 ... 
    ##    30         0.0354    0.010 0.129 0.222 ... 
    ##    36         0.0098
    ## timing iterateEM: 0.208 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10        12.7909    0.010 0.340 0.178 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.2857    0.015 0.510 0.475 ... 
    ##    28         0.0097
    ## timing iterateEM: 1.579 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10         5.7344    0.010 0.167 0.208 ... 
    ## [1] "Removing overlaps!"
    ##    20        91.2272    0.019 0.505 0.476 ... 
    ##    30        14.9585    0.010 0.258 0.289 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2266    0.013 0.449 0.537 ... 
    ##    50         0.0234    0.010 0.264 0.320 ... 
    ##    55         0.0091
    ## timing iterateEM: 0.339 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 5 clusters
    ## Iteration       delta LL
    ##    10         4.5891    0.010 0.266 0.210 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.7079    1.000 0.000 0.000 ... 
    ##    30        28.5626    0.010 0.248 0.275 ... 
    ## [1] "Removing overlaps!"
    ##    40        16.3324    0.014 0.533 0.453 ... 
    ##    50         0.0259    0.010 0.278 0.346 ... 
    ##    55         0.0059
    ## timing iterateEM: 0.355 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10        36.1942    0.010 0.312 0.211 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.5148    0.015 0.494 0.491 ... 
    ##    30         0.0545    0.010 0.323 0.296 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0210    0.015 0.489 0.495 ... 
    ##    50         0.0101    0.010 0.322 0.299 ... 
    ##    52         0.0094
    ## timing iterateEM: 0.37 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10       178.2080    0.010 0.191 0.095 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.0372    0.015 0.507 0.477 ... 
    ##    30         1.8822    0.010 0.254 0.037 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0450    0.014 0.451 0.535 ... 
    ##    50         0.0454    0.010 0.262 0.048 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3067    0.015 0.501 0.484 ... 
    ##    70         0.3347    0.010 0.240 0.080 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0893    0.016 0.491 0.494 ... 
    ##    90         0.0126    0.010 0.220 0.111 ... 
    ##    93         0.0082
    ## timing iterateEM: 0.63 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10       190.5752    0.010 0.140 0.200 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.2083    0.014 0.516 0.470 ... 
    ##    29         0.0089
    ## timing iterateEM: 0.228 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10       131.8138    0.010 0.107 0.297 ... 
    ##    19         0.0073
    ## timing iterateEM: 0.076 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 6 clusters
    ## Iteration       delta LL
    ##    10        50.6375    0.010 0.262 0.084 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.5144    0.015 0.515 0.470 ... 
    ##    30         0.0662    0.010 0.259 0.082 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0147    0.015 0.512 0.473 ... 
    ##    44         0.0093
    ## timing iterateEM: 0.367 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10        12.5854    0.010 0.058 0.172 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.3216    0.015 0.459 0.527 ... 
    ##    30         0.0851    0.010 0.059 0.162 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0145    0.015 0.469 0.516 ... 
    ##    43         0.0094
    ## timing iterateEM: 0.397 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10       160.1479    0.010 0.325 0.205 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.5783    0.015 0.533 0.451 ... 
    ##    30         1.2331    0.010 0.342 0.315 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0979    0.014 0.463 0.523 ... 
    ##    50         0.0636    0.010 0.338 0.320 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.5365    0.014 0.465 0.522 ... 
    ##    70         0.2824    0.010 0.338 0.319 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0254    0.014 0.464 0.522 ... 
    ##    90         0.0093
    ## timing iterateEM: 0.853 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10        25.9516    0.010 0.105 0.350 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.1716    0.015 0.528 0.457 ... 
    ##    30         1.6294    0.010 0.062 0.345 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0341    0.028 0.972 0.000 ... 
    ##    50         0.0129    0.010 0.049 0.344 ... 
    ##    54         0.0099
    ## timing iterateEM: 0.409 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10       132.4438    0.010 0.112 0.124 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.5512    0.026 0.974 0.000 ... 
    ##    30         0.0487    0.010 0.108 0.071 ... 
    ##    38         0.0091
    ## timing iterateEM: 0.228 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 7 clusters
    ## Iteration       delta LL
    ##    10         1.8277    0.010 0.146 0.202 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.5127    1.000 0.000 0.000 ... 
    ##    30        55.7413    0.010 0.097 0.138 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0443    0.023 0.977 0.000 ... 
    ##    44         0.0079
    ## timing iterateEM: 0.514 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10        12.2166    0.010 0.052 0.132 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.0605    0.032 0.968 0.000 ... 
    ##    30         1.8660    0.010 0.038 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1763    0.026 0.974 0.000 ... 
    ##    50         0.0447    0.010 0.034 0.128 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0626    0.026 0.974 0.000 ... 
    ##    70         0.1058    0.010 0.033 0.128 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0085    0.026 0.974 0.000 ... 
    ##    81         0.0085
    ## timing iterateEM: 1.555 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10        32.1141    0.010 0.151 0.120 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.7889    0.031 0.969 0.000 ... 
    ##    30         3.7318    0.010 0.187 0.144 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1426    0.025 0.975 0.000 ... 
    ##    50         0.0082    0.010 0.211 0.149 ... 
    ##    51         0.0082
    ## timing iterateEM: 0.449 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10         9.5134    0.010 0.178 0.171 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.6477    0.015 0.485 0.500 ... 
    ##    30         1.4964    0.010 0.177 0.161 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1373    0.029 0.971 0.000 ... 
    ##    48         0.0097
    ## timing iterateEM: 0.47 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10         2.3711    0.010 0.096 0.106 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.0184    1.000 0.000 0.000 ... 
    ##    30         0.6570    0.010 0.028 0.092 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6995    1.000 0.000 0.000 ... 
    ##    50         2.5545    0.010 0.013 0.092 ... 
    ## [1] "Removing overlaps!"
    ##    60        39.8617    1.000 0.000 0.000 ... 
    ##    70         8.4062    0.010 0.038 0.133 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.4123    0.028 0.972 0.000 ... 
    ##    90         0.3252    0.010 0.037 0.120 ... 
    ## [1] "Removing overlaps!"
    ##   100         2.9516    0.015 0.522 0.463 ... 
    ##   110         0.4585    0.010 0.031 0.093 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.4544    0.014 0.531 0.455 ... 
    ##   130         0.2630    0.010 0.033 0.070 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0679    0.013 0.485 0.502 ... 
    ##   150         0.0138    0.010 0.038 0.070 ... 
    ##   154         0.0091
    ## timing iterateEM: 2.868 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 8 clusters
    ## Iteration       delta LL
    ##    10         7.8235    0.010 0.100 0.232 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.0277    0.027 0.973 0.000 ... 
    ##    30         0.0093    0.010 0.100 0.250 ... 
    ##    31         0.0093
    ## timing iterateEM: 0.245 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        19.1213    0.010 0.140 0.154 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.3450    0.026 0.974 0.000 ... 
    ##    30         1.0092    0.010 0.142 0.156 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.5459    0.026 0.974 0.000 ... 
    ##    50         0.4831    0.010 0.147 0.161 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.5286    0.026 0.974 0.000 ... 
    ##    70         0.6064    0.010 0.155 0.171 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0201    0.018 0.680 0.302 ... 
    ##    90         0.0107    0.010 0.158 0.174 ... 
    ##    94         0.0098
    ## timing iterateEM: 1.064 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        12.9099    0.010 0.105 0.089 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.2192    0.026 0.974 0.000 ... 
    ##    30         0.7924    0.010 0.109 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5883    0.014 0.517 0.469 ... 
    ##    50         0.1872    0.010 0.110 0.023 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0375    0.013 0.534 0.453 ... 
    ##    69         0.0088
    ## timing iterateEM: 1.486 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        20.7858    0.010 0.117 0.092 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.6775    0.026 0.974 0.000 ... 
    ##    30         0.4223    0.010 0.126 0.059 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1108    0.025 0.975 0.000 ... 
    ##    50         0.1053    0.010 0.118 0.055 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1983    0.026 0.974 0.000 ... 
    ##    70         0.3423    0.010 0.102 0.052 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1350    0.023 0.101 0.876 ... 
    ##    90         0.0569    0.010 0.081 0.049 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0570    0.023 0.111 0.866 ... 
    ##   110         0.0978    0.010 0.065 0.049 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0163    0.023 0.118 0.859 ... 
    ##   128         0.0094
    ## timing iterateEM: 1.744 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        16.5509    0.010 0.311 0.064 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.2095    1.000 0.000 0.000 ... 
    ##    30         0.0726    0.010 0.315 0.077 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1722    1.000 0.000 0.000 ... 
    ##    50         0.5946    0.010 0.317 0.099 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.6290    1.000 0.000 0.000 ... 
    ##    70         0.5482    0.010 0.318 0.153 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0313    0.026 0.820 0.154 ... 
    ##    90         0.0150    0.010 0.319 0.169 ... 
    ##    99         0.0097
    ## timing iterateEM: 1.044 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 9 clusters
    ## Iteration       delta LL
    ##    10        33.0759    0.010 0.071 0.135 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.2151    0.030 0.970 0.000 ... 
    ##    30         0.5737    0.010 0.033 0.171 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.3610    0.030 0.970 0.000 ... 
    ##    50         0.0542    0.010 0.033 0.170 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0171    0.029 0.971 0.000 ... 
    ##    70         0.0097    0.010 0.032 0.161 ... 
    ##    71         0.0097
    ## timing iterateEM: 1.345 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        14.2752    0.010 0.269 0.111 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.2311    1.000 0.000 0.000 ... 
    ##    30         4.8434    0.010 0.315 0.119 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5115    0.166 0.834 0.000 ... 
    ##    50         0.5119    0.010 0.325 0.117 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.5598    0.163 0.837 0.000 ... 
    ##    70         0.3435    0.010 0.324 0.119 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5503    0.026 0.838 0.135 ... 
    ##    90         0.4725    0.010 0.321 0.131 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1159    0.025 0.795 0.180 ... 
    ##   110         0.0352    0.010 0.321 0.139 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0184    0.025 0.795 0.180 ... 
    ##   129         0.0096
    ## timing iterateEM: 1.686 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        82.6832    0.010 0.087 0.060 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.9313    0.028 0.972 0.000 ... 
    ##    30         1.4531    0.010 0.053 0.073 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6248    0.023 0.101 0.877 ... 
    ##    50         0.0138    0.010 0.047 0.074 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0162    0.022 0.100 0.877 ... 
    ##    70         0.0758    0.010 0.041 0.074 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.4301    0.022 0.098 0.879 ... 
    ##    90         0.2992    0.010 0.025 0.074 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1039    0.021 0.145 0.834 ... 
    ##   110         0.1065    0.010 0.015 0.075 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0448    0.021 0.836 0.143 ... 
    ##   124         0.0082
    ## timing iterateEM: 2.375 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        16.7637    0.010 0.038 0.309 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.9599    0.031 0.969 0.000 ... 
    ##    30         0.2110    0.010 0.024 0.312 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2376    0.026 0.974 0.000 ... 
    ##    50         0.1054    0.010 0.024 0.312 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0685    0.026 0.974 0.000 ... 
    ##    70         0.0454    0.010 0.024 0.313 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0291    0.026 0.974 0.000 ... 
    ##    90         0.0220    0.010 0.024 0.313 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0310    0.026 0.974 0.000 ... 
    ##   110         0.1406    0.010 0.024 0.313 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.4715    0.025 0.975 0.000 ... 
    ##   130         0.1595    0.010 0.023 0.313 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2952    0.025 0.975 0.000 ... 
    ##   150         0.0146    0.010 0.021 0.314 ... 
    ##   152         0.0086
    ## timing iterateEM: 2.653 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        19.5115    0.010 0.110 0.042 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.8989    0.030 0.970 0.000 ... 
    ##    30         1.0753    0.010 0.049 0.070 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.7955    0.028 0.972 0.000 ... 
    ##    50         0.6839    0.010 0.027 0.081 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1515    0.027 0.973 0.000 ... 
    ##    70         0.0760    0.010 0.018 0.065 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1026    0.027 0.973 0.000 ... 
    ##    90         0.9506    0.010 0.016 0.060 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.6781    0.024 0.976 0.000 ... 
    ##   110         0.1210    0.010 0.013 0.095 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0961    0.024 0.976 0.000 ... 
    ##   130         0.1606    0.010 0.015 0.111 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.5988    0.024 0.976 0.000 ... 
    ##   150         1.1606    0.010 0.017 0.134 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.1274    0.016 0.093 0.891 ... 
    ##   170         0.2099    0.010 0.017 0.148 ... 
    ## [1] "Removing overlaps!"
    ##   180         1.1898    0.016 0.061 0.922 ... 
    ##   185         0.0082
    ## timing iterateEM: 3.332 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10         8.8779    0.010 0.057 0.031 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.2620    0.030 0.970 0.000 ... 
    ##    30         0.4221    0.010 0.068 0.035 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0990    0.025 0.975 0.000 ... 
    ##    50         0.3856    0.010 0.066 0.034 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2618    0.026 0.974 0.000 ... 
    ##    70         0.0806    0.010 0.064 0.034 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0849    0.026 0.974 0.000 ... 
    ##    90         0.2214    0.010 0.064 0.033 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.7352    0.026 0.974 0.000 ... 
    ##   110         0.2573    0.010 0.064 0.033 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1921    0.025 0.975 0.000 ... 
    ##   126         0.0090
    ## timing iterateEM: 1.814 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        20.6555    0.010 0.076 0.085 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.5185    0.030 0.970 0.000 ... 
    ##    30         2.2078    0.010 0.074 0.089 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.9158    0.030 0.970 0.000 ... 
    ##    50         0.3064    0.010 0.074 0.086 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0611    0.030 0.970 0.000 ... 
    ##    70         0.0403    0.010 0.075 0.086 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0642    0.030 0.970 0.000 ... 
    ##    90         0.4737    0.010 0.074 0.086 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.7626    0.024 0.976 0.000 ... 
    ##   109         0.0062
    ## timing iterateEM: 2.386 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10         7.9279    0.010 0.136 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    20         6.6247    1.000 0.000 0.000 ... 
    ##    30         3.1967    0.010 0.157 0.150 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.1301    0.024 0.976 0.000 ... 
    ##    50         0.1015    0.010 0.163 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0358    0.024 0.976 0.000 ... 
    ##    70         0.0626    0.010 0.163 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.6452    0.024 0.976 0.000 ... 
    ##    90         1.5658    0.010 0.165 0.157 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.2806    0.011 0.032 0.510 ... 
    ##   106         0.0096
    ## timing iterateEM: 2.648 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        38.0266    0.010 0.063 0.127 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.8285    1.000 0.000 0.000 ... 
    ##    30         1.8545    0.010 0.070 0.124 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1697    0.104 0.896 0.000 ... 
    ##    50         0.1257    0.010 0.070 0.126 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0389    0.104 0.896 0.000 ... 
    ##    68         0.0083
    ## timing iterateEM: 1.099 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        19.9301    0.010 0.022 0.112 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.0727    1.000 0.000 0.000 ... 
    ##    30         0.9813    0.010 0.024 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2600    0.028 0.972 0.000 ... 
    ##    48         0.0097
    ## timing iterateEM: 0.717 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10        30.2982    0.010 0.119 0.092 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.1057    1.000 0.000 0.000 ... 
    ##    30         0.2694    0.010 0.144 0.060 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.1601    0.137 0.863 0.000 ... 
    ##    50         0.1116    0.010 0.145 0.044 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0290    0.134 0.866 0.000 ... 
    ##    70         0.0136    0.010 0.145 0.035 ... 
    ##    74         0.0088
    ## timing iterateEM: 1.057 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        56.5659    0.010 0.102 0.185 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.4234    0.167 0.833 0.000 ... 
    ##    30         0.1214    0.010 0.113 0.202 ... 
    ##    40         0.0093
    ## timing iterateEM: 0.502 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        12.8337    0.010 0.056 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.3056    0.030 0.970 0.000 ... 
    ##    30         1.2206    0.010 0.057 0.063 ... 
    ## [1] "Removing overlaps!"
    ##    40         2.1565    0.029 0.971 0.000 ... 
    ##    50         1.9372    0.010 0.056 0.128 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4494    0.070 0.375 0.555 ... 
    ##    70         0.3718    0.010 0.055 0.170 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.7828    0.067 0.354 0.579 ... 
    ##    90         0.0546    0.010 0.055 0.172 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.7353    0.021 0.105 0.874 ... 
    ##   110         0.4798    0.010 0.055 0.163 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.7080    0.019 0.160 0.821 ... 
    ##   130         0.3498    0.010 0.056 0.135 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0838    0.019 0.792 0.190 ... 
    ##   150         0.0250    0.010 0.057 0.112 ... 
    ##   159         0.0094
    ## timing iterateEM: 3.576 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        20.5441    0.010 0.061 0.039 ... 
    ## [1] "Removing overlaps!"
    ##    20         5.5187    0.030 0.970 0.000 ... 
    ##    30         1.4821    0.010 0.052 0.024 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.4012    0.024 0.072 0.904 ... 
    ##    50         0.4825    0.010 0.053 0.016 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3811    0.023 0.078 0.899 ... 
    ##    70         0.1098    0.010 0.060 0.008 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0253    0.023 0.016 0.084 ... 
    ##    90         0.0421    0.010 0.060 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1114    0.022 0.016 0.091 ... 
    ##   110         0.3876    0.010 0.061 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   120         2.2868    0.020 0.014 0.084 ... 
    ##   130         0.1448    0.010 0.061 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0128    0.020 0.014 0.068 ... 
    ##   142         0.0087
    ## timing iterateEM: 3.025 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        19.8999    0.010 0.053 0.105 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.3306    0.122 0.878 0.000 ... 
    ##    30         4.0109    0.010 0.056 0.112 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.3987    0.025 0.199 0.775 ... 
    ##    50         0.4909    0.010 0.056 0.112 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3400    0.018 0.145 0.837 ... 
    ##    70         1.6959    0.010 0.056 0.112 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5081    0.016 0.076 0.141 ... 
    ##    90         1.2949    0.010 0.056 0.112 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0309    0.016 0.051 0.138 ... 
    ##   105         0.0088
    ## timing iterateEM: 2.495 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10        20.0482    0.010 0.149 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.7633    0.031 0.969 0.000 ... 
    ##    30         0.6640    0.010 0.152 0.027 ... 
    ## [1] "Removing overlaps!"
    ##    40         4.6178    0.031 0.969 0.000 ... 
    ##    50         0.5885    0.010 0.158 0.024 ... 
    ## [1] "Removing overlaps!"
    ##    60         2.5477    0.027 0.973 0.000 ... 
    ##    70         0.3755    0.010 0.161 0.020 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5100    0.024 0.976 0.000 ... 
    ##    90         0.1511    0.010 0.165 0.030 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1114    0.024 0.976 0.000 ... 
    ##   110         0.0549    0.010 0.166 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0085    0.023 0.049 0.928 ... 
    ##   121         0.0085
    ## timing iterateEM: 3.029 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        10.9023    0.010 0.154 0.066 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.2230    1.000 0.000 0.000 ... 
    ##    30         2.8937    0.010 0.160 0.046 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.8025    0.188 0.812 0.000 ... 
    ##    50         0.3155    0.010 0.159 0.043 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.3909    0.091 0.392 0.517 ... 
    ##    70         0.4790    0.010 0.159 0.045 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.4761    0.079 0.439 0.482 ... 
    ##    90         0.0999    0.010 0.159 0.054 ... 
    ##    97         0.0095
    ## timing iterateEM: 2.251 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10       115.1419    0.010 0.281 0.130 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.7210    1.000 0.000 0.000 ... 
    ##    30         0.6219    0.010 0.312 0.161 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6689    0.027 0.837 0.136 ... 
    ##    50         0.5412    0.010 0.317 0.161 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2659    0.026 0.833 0.141 ... 
    ##    70         0.1750    0.010 0.323 0.161 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1345    0.024 0.141 0.835 ... 
    ##    90         0.2133    0.010 0.323 0.162 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3490    0.030 0.970 0.000 ... 
    ##   110         0.3521    0.010 0.323 0.162 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1633    0.025 0.794 0.008 ... 
    ##   130         0.0992    0.010 0.324 0.161 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1442    0.024 0.793 0.008 ... 
    ##   150         0.2751    0.010 0.325 0.161 ... 
    ## [1] "Removing overlaps!"
    ##   160         1.1675    0.022 0.715 0.007 ... 
    ##   170         1.1595    0.010 0.325 0.161 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.0263    0.019 0.006 0.053 ... 
    ##   190         0.0107    0.010 0.327 0.161 ... 
    ##   192         0.0098
    ## timing iterateEM: 4.887 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        16.1541    0.010 0.034 0.144 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.1514    0.133 0.867 0.000 ... 
    ##    30         1.0506    0.010 0.035 0.143 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2310    0.142 0.858 0.000 ... 
    ##    50         0.1602    0.010 0.035 0.146 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1988    0.135 0.865 0.000 ... 
    ##    70         0.5958    0.010 0.035 0.146 ... 
    ## [1] "Removing overlaps!"
    ##    80         6.0181    0.050 0.327 0.623 ... 
    ##    85         0.0068
    ## timing iterateEM: 2.188 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10         8.4626    0.010 0.054 0.110 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.8640    1.000 0.000 0.000 ... 
    ##    30         0.8452    0.010 0.044 0.107 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0864    1.000 0.000 0.000 ... 
    ##    50         0.0358    0.010 0.029 0.107 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0456    1.000 0.000 0.000 ... 
    ##    70         0.2574    0.010 0.022 0.108 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.6527    1.000 0.000 0.000 ... 
    ##    90         0.0104    0.010 0.020 0.110 ... 
    ##    92         0.0084
    ## timing iterateEM: 2.16 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        14.3725    0.010 0.036 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.7305    0.149 0.851 0.000 ... 
    ##    30         0.9886    0.010 0.027 0.043 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6677    0.141 0.859 0.000 ... 
    ##    50         0.3887    0.010 0.023 0.033 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.8397    0.156 0.844 0.000 ... 
    ##    70         0.0858    0.010 0.018 0.026 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0349    0.107 0.893 0.000 ... 
    ##    90         0.0406    0.010 0.017 0.020 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1136    0.108 0.892 0.000 ... 
    ##   110         1.0740    0.010 0.016 0.016 ... 
    ## [1] "Removing overlaps!"
    ##   120         1.0989    0.022 0.075 0.719 ... 
    ##   130         0.1185    0.010 0.017 0.014 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1541    0.018 0.058 0.151 ... 
    ##   150         0.1663    0.010 0.028 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.2433    0.018 0.056 0.149 ... 
    ##   170         0.2921    0.010 0.038 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.2248    0.042 0.132 0.481 ... 
    ##   190         0.1668    0.010 0.041 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0763    0.017 0.054 0.140 ... 
    ##   210         0.0303    0.010 0.040 0.013 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0141    0.022 0.069 0.731 ... 
    ##   227         0.0095
    ## timing iterateEM: 5.607 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10         1.6066    0.010 0.078 0.083 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.3821    1.000 0.000 0.000 ... 
    ##    30        33.7213    0.010 0.021 0.075 ... 
    ## [1] "Removing overlaps!"
    ##    40         3.7154    0.028 0.972 0.000 ... 
    ##    50         3.0320    0.010 0.014 0.064 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.0717    0.028 0.972 0.000 ... 
    ##    70         2.2797    0.010 0.021 0.056 ... 
    ## [1] "Removing overlaps!"
    ##    80         1.0272    0.026 0.889 0.085 ... 
    ##    90         1.0582    0.010 0.022 0.052 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1350    0.023 0.072 0.905 ... 
    ##   110         0.0254    0.010 0.020 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0220    0.023 0.072 0.906 ... 
    ##   130         0.0206    0.010 0.018 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0191    0.023 0.072 0.906 ... 
    ##   150         0.0179    0.010 0.017 0.055 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.0161    0.022 0.068 0.046 ... 
    ##   164         0.0099
    ## timing iterateEM: 4.441 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        12.5313    0.010 0.120 0.050 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.6587    0.161 0.839 0.000 ... 
    ##    30         0.9787    0.010 0.086 0.060 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.6343    0.152 0.848 0.000 ... 
    ##    50         0.4778    0.010 0.039 0.111 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.6788    0.142 0.858 0.000 ... 
    ##    70         0.3490    0.010 0.022 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0932    0.071 0.450 0.479 ... 
    ##    90         0.1858    0.010 0.014 0.171 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.7545    0.066 0.428 0.506 ... 
    ##   110         0.0137    0.010 0.011 0.174 ... 
    ##   112         0.0084
    ## timing iterateEM: 2.722 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        20.9392    0.010 0.131 0.088 ... 
    ## [1] "Removing overlaps!"
    ##    20         2.3576    1.000 0.000 0.000 ... 
    ##    30         0.4652    0.010 0.131 0.091 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.2789    1.000 0.000 0.000 ... 
    ##    49         0.0096
    ## timing iterateEM: 0.928 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        88.9860    0.010 0.110 0.037 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.6398    1.000 0.000 0.000 ... 
    ##    30         1.9820    0.010 0.123 0.021 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.9084    0.120 0.880 0.000 ... 
    ##    50         0.7323    0.010 0.092 0.021 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.5771    0.120 0.880 0.000 ... 
    ##    70         0.2441    0.010 0.065 0.021 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1065    0.016 0.121 0.862 ... 
    ##    90         0.0854    0.010 0.054 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1482    0.016 0.137 0.847 ... 
    ##   110         0.2144    0.010 0.047 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1754    0.016 0.848 0.136 ... 
    ##   130         0.2194    0.010 0.038 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   140         1.9219    0.016 0.045 0.006 ... 
    ##   150         0.0657    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.1015    0.016 0.042 0.006 ... 
    ##   170         0.1790    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.2203    0.016 0.041 0.005 ... 
    ##   190         0.1272    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0821    0.015 0.038 0.005 ... 
    ##   210         0.0563    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0404    0.015 0.038 0.005 ... 
    ##   230         0.0311    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   240         0.0260    0.015 0.038 0.005 ... 
    ##   250         0.0232    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   260         0.0212    0.015 0.038 0.005 ... 
    ##   270         0.0187    0.010 0.026 0.021 ... 
    ## [1] "Removing overlaps!"
    ##   280         0.0147    0.015 0.038 0.005 ... 
    ##   290         0.0096    0.010 0.026 0.021 ... 
    ##   291         0.0096
    ## timing iterateEM: 8.599 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        15.8979    0.010 0.042 0.030 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.8111    1.000 0.000 0.000 ... 
    ##    30         4.0048    0.010 0.051 0.036 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.5953    1.000 0.000 0.000 ... 
    ##    50         1.3638    0.010 0.058 0.050 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2202    0.120 0.074 0.806 ... 
    ##    70         0.1324    0.010 0.055 0.048 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.1727    0.070 0.043 0.520 ... 
    ##    90         0.6644    0.010 0.051 0.042 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3223    0.067 0.267 0.041 ... 
    ##   110         0.7338    0.010 0.049 0.039 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.4071    0.039 0.152 0.024 ... 
    ##   130         0.1858    0.010 0.042 0.039 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.2167    0.040 0.158 0.025 ... 
    ##   150         0.5537    0.010 0.030 0.041 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.7627    0.041 0.171 0.025 ... 
    ##   170         0.8913    0.010 0.035 0.043 ... 
    ## [1] "Removing overlaps!"
    ##   180         1.2539    0.043 0.187 0.029 ... 
    ##   190         0.0258    0.010 0.041 0.043 ... 
    ## [1] "Removing overlaps!"
    ##   200         0.0186    0.044 0.190 0.029 ... 
    ##   210         0.0138    0.010 0.045 0.044 ... 
    ## [1] "Removing overlaps!"
    ##   220         0.0104    0.044 0.193 0.029 ... 
    ##   223         0.0098
    ## timing iterateEM: 5.554 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        23.9913    0.010 0.021 0.037 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.4519    0.136 0.864 0.000 ... 
    ##    30         1.7577    0.010 0.011 0.018 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.4569    0.132 0.868 0.000 ... 
    ##    50         1.1651    0.010 0.011 0.016 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4372    0.098 0.669 0.233 ... 
    ##    70         0.0986    0.010 0.011 0.016 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0109    0.019 0.131 0.001 ... 
    ##    82         0.0093
    ## timing iterateEM: 2.682 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        17.3169    0.010 0.040 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    20         4.5669    0.032 0.968 0.000 ... 
    ##    30         0.9658    0.010 0.028 0.066 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5974    1.000 0.000 0.000 ... 
    ##    50         0.2182    0.010 0.035 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.1572    1.000 0.000 0.000 ... 
    ##    70         0.1597    0.010 0.042 0.068 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.3056    1.000 0.000 0.000 ... 
    ##    90         1.4816    0.010 0.046 0.068 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.1007    0.281 0.719 0.000 ... 
    ##   107         0.0097
    ## timing iterateEM: 3.52 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        16.9615    0.010 0.104 0.103 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.1874    0.030 0.970 0.000 ... 
    ##    30         0.5792    0.010 0.101 0.099 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.5455    0.025 0.975 0.000 ... 
    ##    50         0.5259    0.010 0.102 0.100 ... 
    ## [1] "Removing overlaps!"
    ##    60         1.8778    0.025 0.975 0.000 ... 
    ##    70         0.5694    0.010 0.103 0.102 ... 
    ## [1] "Removing overlaps!"
    ##    80         2.2784    0.022 0.104 0.874 ... 
    ##    90         0.1424    0.010 0.103 0.102 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0892    0.019 0.754 0.227 ... 
    ##   110         0.0720    0.010 0.104 0.102 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1630    0.019 0.016 0.723 ... 
    ##   130         0.3331    0.010 0.104 0.103 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0420    0.018 0.008 0.727 ... 
    ##   142         0.0078
    ## timing iterateEM: 5.019 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        19.5899    0.010 0.057 0.115 ... 
    ## [1] "Removing overlaps!"
    ##    20         9.2109    1.000 0.000 0.000 ... 
    ##    30         1.8444    0.010 0.032 0.131 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.7997    0.128 0.872 0.000 ... 
    ##    50         0.3428    0.010 0.026 0.141 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0571    0.090 0.078 0.832 ... 
    ##    70         0.1289    0.010 0.019 0.144 ... 
    ##    76         0.0096
    ## timing iterateEM: 1.691 sec elapsed
    ## Starting EM with threshold 0.0100 threshold, 15 clusters
    ## Iteration       delta LL
    ##    10        22.8914    0.010 0.093 0.038 ... 
    ## [1] "Removing overlaps!"
    ##    20         1.0578    1.000 0.000 0.000 ... 
    ##    30         0.6496    0.010 0.097 0.025 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.3570    1.000 0.000 0.000 ... 
    ##    50         0.4079    0.010 0.098 0.020 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.2563    1.000 0.000 0.000 ... 
    ##    70         0.6061    0.010 0.098 0.017 ... 
    ## [1] "Removing overlaps!"
    ##    80         1.1971    0.526 0.474 0.000 ... 
    ##    90         1.4433    0.010 0.102 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.3538    0.146 0.205 0.544 ... 
    ##   110         0.1568    0.010 0.105 0.007 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.1445    0.121 0.174 0.507 ... 
    ##   130         0.3057    0.010 0.105 0.011 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.5863    0.061 0.066 0.043 ... 
    ##   150         1.6025    0.010 0.105 0.016 ... 
    ##   160         0.0077
    ## timing iterateEM: 4.712 sec elapsed
    ## sampled subset EM: 146.525 sec elapsed
    ## full calculation with 10 clusters, idx 6
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 10 clusters
    ## Iteration       delta LL
    ##    10        27.2176    0.010 0.324 0.140 ... 
    ## [1] "Removing overlaps!"
    ##    20         8.4760    0.024 0.785 0.191 ... 
    ##    30         9.4032    0.010 0.329 0.153 ... 
    ## [1] "Removing overlaps!"
    ##    40        22.8356    0.024 0.784 0.192 ... 
    ##    50        26.1754    0.010 0.327 0.178 ... 
    ## [1] "Removing overlaps!"
    ##    60         6.9925    0.021 0.167 0.812 ... 
    ##    70         0.8061    0.010 0.326 0.191 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.0535    0.021 0.169 0.810 ... 
    ##    86         0.0075
    ## timing iterateEM: 22.01 sec elapsed
    ## full calculation with 11 clusters, idx 7
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 11 clusters
    ## Iteration       delta LL
    ##    10         6.3197    0.010 0.166 0.156 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.3198    0.018 0.732 0.249 ... 
    ##    30         1.3296    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.7307    0.018 0.737 0.244 ... 
    ##    50         0.5498    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.4322    0.011 0.035 0.498 ... 
    ##    70         0.3229    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.2272    0.011 0.035 0.497 ... 
    ##    90         0.1524    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.0990    0.011 0.035 0.496 ... 
    ##   110         0.0634    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.0404    0.011 0.035 0.495 ... 
    ##   130         0.0260    0.010 0.166 0.157 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.0169    0.011 0.035 0.495 ... 
    ##   150         0.0111    0.010 0.166 0.157 ... 
    ##   154         0.0098
    ## timing iterateEM: 56.722 sec elapsed
    ## full calculation with 12 clusters, idx 8
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 12 clusters
    ## Iteration       delta LL
    ##    10         6.9546    0.010 0.067 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    20         3.6080    0.021 0.841 0.138 ... 
    ##    30         2.4519    0.010 0.067 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    40         1.8815    0.021 0.849 0.130 ... 
    ##    50         0.2402    0.010 0.067 0.012 ... 
    ## [1] "Removing overlaps!"
    ##    60         0.0077    0.021 0.853 0.126 ... 
    ##    61         0.0077
    ## timing iterateEM: 16.917 sec elapsed
    ## full calculation with 13 clusters, idx 9
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 13 clusters
    ## Iteration       delta LL
    ##    10        13.1384    0.010 0.150 0.063 ... 
    ## [1] "Removing overlaps!"
    ##    20         0.9466    0.073 0.424 0.504 ... 
    ##    30         0.1071    0.010 0.150 0.061 ... 
    ## [1] "Removing overlaps!"
    ##    40         0.0269    0.073 0.427 0.500 ... 
    ##    49         0.0087
    ## timing iterateEM: 12.867 sec elapsed
    ## full calculation with 14 clusters, idx 10
    ## [1] "parFull, minMinor= 500"
    ## [1] "flowEMMiFull, minMinor= 500"
    ## Starting EM with threshold 0.0100 threshold, 14 clusters
    ## Iteration       delta LL
    ##    10        18.5073    0.010 0.020 0.057 ... 
    ## [1] "Removing overlaps!"
    ##    20        22.2296    0.023 0.071 0.051 ... 
    ##    30        13.9252    0.010 0.023 0.055 ... 
    ## [1] "Removing overlaps!"
    ##    40         7.1029    0.022 0.067 0.043 ... 
    ##    50         6.2959    0.010 0.027 0.061 ... 
    ## [1] "Removing overlaps!"
    ##    60         5.3087    0.022 0.068 0.042 ... 
    ##    70         1.7714    0.010 0.032 0.065 ... 
    ## [1] "Removing overlaps!"
    ##    80         0.5582    0.012 0.038 0.494 ... 
    ##    90         0.4466    0.010 0.034 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   100         0.6437    0.012 0.038 0.494 ... 
    ##   110         0.5337    0.010 0.037 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   120         0.2516    0.012 0.038 0.494 ... 
    ##   130         0.1808    0.010 0.038 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   140         0.1712    0.012 0.038 0.494 ... 
    ##   150         0.1757    0.010 0.039 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   160         0.1959    0.012 0.038 0.494 ... 
    ##   170         0.2535    0.010 0.040 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   180         0.4276    0.012 0.038 0.494 ... 
    ##   190         1.0546    0.010 0.040 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   200         2.9869    0.012 0.038 0.494 ... 
    ##   210         3.3649    0.010 0.041 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   220         2.4224    0.012 0.038 0.494 ... 
    ##   230         2.3059    0.010 0.042 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   240         2.3721    0.012 0.038 0.494 ... 
    ##   250         3.2480    0.010 0.043 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   260        11.4510    0.012 0.038 0.494 ... 
    ##   270        30.5716    0.010 0.044 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   280        67.1286    0.012 0.045 0.489 ... 
    ##   290        36.4434    0.010 0.046 0.066 ... 
    ## [1] "Removing overlaps!"
    ##   300         0.8941    0.012 0.009 0.046 ... 
    ##   308         0.0098
    ## timing iterateEM: 149.366 sec elapsed
    ## full EM run on best subset of clusters: 273.863 sec elapsed

``` r
plot_g <- plotDensityAndEllipses(fcsData = test, ch1="FS.Log", ch2="FL.4.Log", alpha=0.9,
                                 logScale = T, results = gating_test$best,
                                 ellipseDotSize = 0.5, axis_size=10, axisLabeling_size=10,
                                 xlab = "Forward Scatter", ylab = "DAPI", font = "Arial")
```

    ## Scale for x is already present.
    ## Adding another scale for x, which will replace the existing scale.
    ## Scale for y is already present.
    ## Adding another scale for y, which will replace the existing scale.
    ## Scale for x is already present.
    ## Adding another scale for x, which will replace the existing scale.
    ## Scale for y is already present.
    ## Adding another scale for y, which will replace the existing scale.
    ## Coordinate system already present. Adding new coordinate system, which will
    ## replace the existing one.

![](02b-flowmix-on-microbial-community-data_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

## Files written

These files have been written to the target directory, data/02b-flowmix
on microbial community data:

``` r
projthis::proj_dir_info(path_target())
```

    ## # A tibble: 0 × 4
    ## # ℹ 4 variables: path <fs::path>, type <fct>, size <fs::bytes>,
    ## #   modification_time <dttm>
